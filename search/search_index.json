{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Obsidian Notes","text":"<p>Publish your public notes with MkDocs</p>"},{"location":"#hello-world","title":"Hello World!","text":"<p>The <code>index.md</code> in the <code>/docs</code> folder is the homepage you see here.</p> <p>The folders in <code>/docs</code> appear as the main sections on the navigation bar.</p> <p>The notes appear as pages within these sections. For example, Note 1 in <code>Topic 1</code></p> <p>thing should be changed now!</p>"},{"location":"Features/LaTeX%20Math%20Support/","title":"LaTeX Math Support","text":"<p>LaTeX math is supported using MathJax.</p> <p>Inline math looks like \\(f(x) = x^2\\). The input for this is <code>$f(x) = x^2$</code>. Use <code>$...$</code>.</p> <p>For a block of math, use <code>$$...$$</code> on separate lines</p> <pre><code>$$\nF(x) = \\int^a_b \\frac{1}{2}x^4\n$$\n</code></pre> <p>gives </p> \\[ F(x) = \\int^a_b \\frac{1}{2}x^4 \\]"},{"location":"Features/Mermaid%20Diagrams/","title":"Mermaid diagrams","text":"<p>Here's the example from MkDocs Material documentation: </p> <pre><code>graph LR\n  A[Start] --&gt; B{Error?};\n  B --&gt;|Yes| C[Hmm...];\n  C --&gt; D[Debug];\n  D --&gt; B;\n  B ----&gt;|No| E[Yay!];</code></pre>"},{"location":"Features/Text%20Formatting/","title":"Text Formatting","text":"<p>You can have lists like this</p> <ul> <li>first</li> <li>second</li> <li>third</li> </ul> <p>Or checklist lists to</p> <ul> <li> Get</li> <li> things</li> <li> done</li> </ul> <p>Also, get highlights and strikethroughs as above (similar to Obsidian).</p> <p>More formatting options for your webpage here. (but not compatible with Obsidian)</p>"},{"location":"Topic%201/Note%201/","title":"Note 1","text":"<p>Example: link to Mermaid Diagrams under <code>Features</code></p>"},{"location":"Topic%201/Note%202/","title":"Note 2","text":""},{"location":"blog/","title":"Blog","text":""},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/","title":"Introduction to Azure Backup","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction","title":"Introduction","text":"<p>Information technology workers understand the importance of data to the organization. The need to protect that data drives decisions around storage, backups, and security. Many companies implement policies that dictate backup specifications for frequency, duration of backup storage, and restore policies.</p> <p>For on-premises scenarios, backup solutions might have included local redundant storage solutions or off-site storage. Scenarios using backup to tape drives and storing offsite come with the resulting delay in restoring the data (because of the need to transport the tapes back to the server rooms and from performing the restore operation). This can result in significant downtime.</p> <p>These backup solutions might not always address some of the most important considerations, such as security of the backups, the potential for the company to be impacted by a ransomware attack, or human error in the backup and restore operations. An ideal solution would be cost-effective, simple to use, and secure. This is where Azure Backup comes in.</p> <p></p> <p>Azure Backup can also address scenarios for your Azure environments, with support for:</p> <ul> <li>Azure VMs</li> <li>Azure Managed Disks</li> <li>Azure Files</li> <li>SQL Server in Azure VMs</li> <li>SAP HANA databases in Azure VMs</li> <li>Azure Database for PostgreSQL servers</li> <li>Azure Blobs</li> <li>Azure Database for PostgreSQL - Flexible servers</li> <li>Azure Database for MySQL - Flexible servers</li> <li>Azure Kubernetes cluster</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#example-scenario","title":"Example scenario","text":"<p>You're running an application powered by SQL Server. The database is running in an always-on availability group across three Azure VMs. You want to back up the databases using an Azure native backup service. You're looking to store the backup for 10 years in cheaper storage for your audit and compliance needs. You'd like to monitor the backup jobs daily for all such databases.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#what-will-we-be-doing","title":"What will we be doing?","text":"<p>We'll evaluate the features and capabilities of Azure Backup to help decide if:</p> <ul> <li>Azure Backup can offer a solution for your backup needs.</li> <li>You can back up and restore the data you need for your organization.</li> <li>Azure Backup offers secure storage of your data.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#what-is-the-main-goal","title":"What is the main goal?","text":"<p>By the end of this session, you'll be able to decide if Azure Backup is the right solution to consider for your data-protection needs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#what-is-azure-backup","title":"What is Azure Backup?","text":"<p>Let's start by defining Azure Backup and taking a quick tour of the core features. This overview should help you decide whether Azure Backup might be a good fit for your data-protection needs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#what-is-azure-backup_1","title":"What is Azure Backup?","text":"<p>The Azure Backup service provides simple, secure, and cost-effective solutions to back up your data and recover it from the Microsoft Azure cloud.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#azure-backup-definition","title":"Azure Backup definition","text":"<p>Azure Backup is an Azure service that provides cost effective, secure, and zero-infrastructure backup solutions for all Azure-managed data assets.</p> <p>The centralized management interface makes it easy to define backup policies and protect a wide range of enterprise workloads, including Azure Virtual Machines, Azure Disks, SQL and SAP databases, Azure file shares, and blobs.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#when-to-use-azure-backup","title":"When to use Azure Backup","text":"<p>As the IT admin of your organization, you're responsible for meeting the compliance needs for all the data assets of the firm, and backup is a critical aspect. There are also various application admins in your company who need to do self-service backup and restore to take care of issues like data corruption or rogue-admin scenarios. You're looking for an enterprise-class backup solution to protect all your workloads and manage them from a central place.</p> <p>Azure Backup can provide backup services for the following data assets:</p> <ul> <li>On-premises files, folders, and system state</li> <li>Azure Virtual Machines (VMs)</li> <li>Azure Managed Disks</li> <li>Azure Files Shares</li> <li>SQL Server in Azure VMs</li> <li>SAP HANA (High-performance Analytic Appliance) databases in Azure VMs</li> <li>Azure Database for PostgreSQL servers</li> <li>Azure Blobs</li> <li>Azure Database for PostgreSQL - Flexible servers</li> <li>Azure Database for MySQL - Flexible servers</li> <li>Azure Kubernetes cluster</li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#key-features","title":"Key features","text":"<p>Let's look at some key features of Azure Backup.</p> Feature Description Usage Zero-infrastructure backup solution Unlike conventional backup solutions, no backup server or infrastructure is needed. Similarly, no backup storage needs to be deployed, because Azure Backup automatically manages and scales it. Zero-infrastructure solution eliminates capital expenses and reduces operational expenses. It increases ease of use by automating storage management. At-scale management Natively manage your entire backup estate from a central console called Backup Center. Use APIs, PowerShell, and Azure CLI to automate Backup policy and security configurations. Backup center simplifies data protection management at-scale by enabling you to discover, govern, monitor, operate, and optimize backup management from one unified console, which helps you to drive operational efficiency with Azure. Security Azure Backup provides built-in security to your backup environment, both when your data is in transit and at rest by using capabilities encryption, private endpoints, alerts, and so on. Your backups are automatically secured against ransomware, malicious admins, and accidental deletions.","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#how-do-recovery-time-objective-and-recovery-point-objective-work","title":"How do Recovery Time Objective and Recovery Point Objective work?","text":"<p>Recovery Time Objective (RTO) is the target time within which a business process must be restored after a disaster occurs to avoid unacceptable consequences. For instance, if a critical application goes down due to a server failure and the business can only tolerate a maximum of four hours of downtime, then the RTO is four hours.</p> <p>Recovery Point Objective (RPO) is the maximum amount of data loss, measured in time, that your organization can sustain during an event.</p> <p>The following example scenario describes both the RPO and RTO concepts:</p> <p>Your organization has an RPO of one hour for your customer database, which means you perform backups every hour. If a data-loss incident occurs, you lose not more than one hour of data. When you set RTO to three hours, then if a system failure occurs, you aim to restore access to the database within three hours to minimize the impact on operations.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#how-azure-backup-works","title":"How Azure Backup works","text":"<p>Let's take a look at how Azure Backup works to provide the data protection you need. Particularly, let's look at how the different aspects of the backup service make it easy to back up various types of data, and how it offers security for your backups as well. In this unit, we cover the following aspects of the Azure Backup Service:</p> <ul> <li>Workload integration layer - Backup Extension: Integration with the actual workload, such as Azure virtual machines (VMs) or Azure Blobs, happens at this layer.</li> <li>Data Plane - Access Tiers: There are three access tiers where the backups could be stored:<ul> <li>Snapshot tier</li> <li>Standard tier</li> <li>Archive tier</li> </ul> </li> <li>Data Plane - Availability and Security: The backup data is replicated across zones or regions, based on the redundancy the user specifies.</li> <li>Management Plane \u2013 Recovery Services vault/Backup vault and Backup center: The vault provides an interface for the user to interact with the backup service.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#what-data-is-backed-up-and-how","title":"What data is backed up and how?","text":"<p>The simplest explanation of Azure Backup is that it backs up data, machine state, and workloads running on on-premises machines and VM instances to the Azure cloud. Azure Backup stores the backed-up data in Recovery Services vaults and Backup vaults.</p> <p>For on-premises Windows machines, you can back up directly to Azure with the Azure Backup Microsoft Azure Recovery Services (MARS) agent. Alternatively, you can back up these Windows machines to a backup server, perhaps a System Center Data Protection Manager (DPM) or Microsoft Azure Backup Server (MABS). You can then back that server up to a Recovery Services vault in Azure.</p> <p>If you're using Azure VMs, you can back them up directly. Azure Backup installs a backup extension to the Azure VM agent that's running on the VM, which allows you to back up the entire VM. If you only want to back up the files and folders on the VM, you can do so by running the MARS agent.</p> <p>Azure Backup stores backed-up data in vaults: Recovery Services vaults and Backup vaults. A vault is an online-storage entity in Azure that's used to hold data such as backup copies, recovery points, and backup policies.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#supported-backup-types","title":"Supported backup types","text":"<p>Azure Backup supports full backups and incremental backups. Your initial backup is a full backup. The incremental backup is used by DPM/MABS use the incremental backup for disk backups, and used in all backups to Azure. As the name suggests, incremental backups only focus on the blocks of data that changed since the previous backup.</p> <p>Azure Backup also supports SQL Server backup types. The following table outlines the support for SQL Server type backups:</p> <p>Expand table</p> Type Description Usage Full A full database backup backs up the entire database. It contains all the data in a specific database or in a set of filegroups or files. A full backup also contains enough logs to recover that data. At most, you can trigger one full backup per day. You can choose to make a full backup on a daily or weekly interval. Differential A differential backup is based on the most recent full-data backup. It captures only the data that changed since the full backup. At most, you can trigger one differential backup per day. You can't configure a full backup and a differential backup on the same day. Multiple backups per day Back up Azure VMs hourly with a minimum recovery point objective (RPO) of 4 hours and a maximum of 24 hours. You can use Enhanced backup policy to set the backup schedule to 4, 6, 8, 12, and 24 hours (respectively) for new Azure offerings, such as Trusted Launch VM. Selective disk backup Selectively back up a subset of the data disks that are attached to your VM, then restore a subset of the disks that are available in a recovery point, both from instant restore and vault tier. Selective disk backup helps you manage critical data in a subset of the VM disks and use database backup solutions when you want to back up only their OS disk to reduce cost. Azure Backup provides Selective Disk backup and restore capability using Enhanced backup policy. Transaction Log A log backup enables point-in-time restoration up to a specific second. At most, you can configure transactional log backups every 15 minutes.","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#workload-integration-layer-backup-extension","title":"Workload integration layer - Backup Extension","text":"<p>A backup extension specific to each workload is installed on the source VM or a worker VM. At the time of backup (as defined by the user in the Backup Policy) the backup extension generates the backup, which could be:</p> <ul> <li> <p>Storage: Snapshots when using an Azure VM or Azure Files.</p> </li> <li> <p>Stream backup: For databases like SQL or High-performance Analytic Appliance (HANA) running in VMs.</p> </li> </ul> <p>The backup data is eventually transferred to Azure Backup managed storage in the data plane by using secure Azure networks Network Security Groups (NSG), Firewalls, or more sophisticated private endpoints.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#data-plane-access-tiers","title":"Data Plane - Access Tiers","text":"<p>There are three access tiers where the backups can be stored:</p> <ul> <li> <p>Snapshot tier: (Workload-specific term) In the first phase of a virtual machine backup, the snapshot is taken and stored along with the disk. This form of storage is referred to as a snapshot tier. Restoring a snapshot tier is faster than restoring from a vault, because it eliminates the wait time for snapshots to be copied from the vault before triggering the restore operation. The snapshots of the VM/Azure Files/Azure Blobs/and so on are retained in the customer's subscription in a specified resource group. This container ensures that restores are quick, because the backup/snapshot is available locally to the customer.</p> </li> <li> <p>Vault-standard tier: Backup data for all workloads supported by Azure Backup is stored in vaults, which hold backup storage, an autoscaling set of storage accounts managed by Azure Backup. The Vault-standard tier is an online storage tier that allows you to store an isolated copy of backup data in a Microsoft-managed tenant, thus creating an extra layer of protection. For workloads where snapshot tier is supported, there's a copy of the backup data in both the snapshot tier and the Vault-standard tier. The Vault-standard tier ensures that backup data is available even if the data source being backed up is deleted or compromised.</p> </li> <li> <p>Archive tier: Customers rely on Azure Backup for storing backup data, including their Long-Term Retention (LTR) backup data, with retention needs defined in the organization's compliance rules. In most cases, the older backup data is rarely accessed and is only stored for compliance needs.</p> <p>Azure Backup supports backup of long-term retention points in the archive tier.</p> </li> </ul> <p>All tiers offer different recovery time objectives (RTO) and are priced differently.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#data-plane-availability-and-security","title":"Data Plane - Availability and Security","text":"<p>The backup data is replicated across zones or regions, based on the redundancy you specify. You can choose from locally redundant storage (LRS), Geo-redundant storage (GRS), or zone-redundant storage (ZRS). These options provide you with highly available data storage capabilities.</p> <p>The data is kept safe by encrypting it and implementing Azure role-based access control (RBAC). You choose who can perform backup and restore operations. Azure Backup also provides protection against malicious deletion of your backup by using soft-delete operations. A deleted backup is stored for 14 days, free of charge, which allows you to recover the backup if needed.</p> <p>Azure Backup also supports a backup data lifecycle-management scenario that allows you to comply with retention policies.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#management-plane-recovery-services-vaultbackup-vault-and-backup-center","title":"Management Plane \u2013 Recovery Services vault/Backup vault and Backup center","text":"<p>Azure Backup uses Recovery Services vaults and Backup vaults to orchestrate and manage backups. It also uses vaults to store backed-up data. The vault provides an interface for the user to interact with the backup service. Azure Backup Policies within each vault define when the backups should get triggered and how long they need to be retained.</p> <p>You can use a single vault or multiple vaults to organize and manage your backup. If you manage your workloads with a single subscription and single resource, you can use a single vault to monitor and manage your backup estate. If your workloads are spread across multiple subscriptions, you can create multiple vaults with one or more vaults per subscription.</p> <p></p> <p>Backup center allows you to have a single pane of glass to manage all tasks related to backups. Backup center is designed to function well across a large and distributed Azure environment. You can use Backup center to efficiently manage backups spanning multiple workload types, vaults, subscriptions, regions, and Azure Lighthouse tenants.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#when-to-use-azure-backup_1","title":"When to use Azure Backup","text":"<p>Here, we'll discuss how you can decide if Azure Backup is the right choice for your data-protection needs. We'll highlight common backup scenarios where Azure Backup provides benefits, such as:</p> <ul> <li>Ensuring availability of your data.</li> <li>Protecting your Azure workloads.</li> <li>Securing your data.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#decision-criteria","title":"Decision criteria","text":"<p>Azure Backup is an Azure service that provides secure and zero-infrastructure backup solutions for all Azure-managed data assets. It protects a wide range of enterprise workloads, including Azure Virtual Machines, Azure Disks, SQL and SAP databases, and Azure file shares and blobs.</p> <p>The main criteria that we're evaluating are outlined in the following table. The table contains some key areas where Azure Backup can provide services to you for data protection.</p> <p>Expand table</p> Criteria Consideration Azure workloads Azure VMs, Azure Disks, SQL Server or SAP HANA databases running in Azure VMs, Azure Blobs, Azure Disks, Azure Database for PostgreSQL. Compliance Customer-defined backup policy with long-term retention across multiple zones or regions. Operational recoveries With self-service backup and restores, the application administrator can take care of issues that might arise such as accidental deletion or data corruption.","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#apply-the-criteria","title":"Apply the criteria","text":"<p>In the introduction, we presented a scenario where your organization might have an application that relies on data from a back-end SQL Server installation. SQL Server is running on three Azure VMs. The data in the backup must be retained for up to 10 years to meet compliance requirements. You also want to be able to monitor the backups.</p> <p>Before we dive into how Azure Backup can help meet these needs, it's important to understand what's not currently supported. If your three Azure VMs are deployed across multiple subscriptions or regions, you should be aware that Azure Backup doesn\u2019t support cross-region backup for most workloads. However, it does support cross-region restore in a paired secondary region.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#can-azure-backup-protect-the-azure-vms-hosting-the-sql-server-instances","title":"Can Azure Backup protect the Azure VMs hosting the SQL Server instances?","text":"<p>Azure Backup is able to back up entire Windows and Linux VMs using backup extensions. As a result, you can back up the entire VM that hosts SQL Server. If you only want to back up the files, folders, and system state on the Azure VMs, you can use the Microsoft Azure Recovery Services (MARS) agent.</p> <p>If your main concern is to only back up the SQL Server data, Azure Backup provides support for that as well. Azure Backup offers a stream-based, specialized solution to back up SQL Servers running in Azure VMs. This solution aligns with Azure Backup's benefits of zero-infrastructure backup, long-term retention, and central management.</p> <p>Additionally, Azure Backup provides the following advantages specifically for SQL Server:</p> <ul> <li>Workload aware backups that support all backup types: full, differential, and log</li> <li>15-minute recovery point objective (RPO) with frequent log backups</li> <li>Point-in-time recovery up to a second</li> <li>Individual database-level backup and restore</li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#does-azure-backup-help-with-compliance","title":"Does Azure Backup help with compliance?","text":"<p>You can implement required access-control mechanisms for your backups. Vaults (Recovery Services and Backup vaults) provide the management capabilities and are accessible via the Azure portal, Backup Center, Vault dashboards, SDK, CLI, and even REST APIs. It's also an Azure role-based access control (Azure RBAC) boundary, providing you with the option to restrict access to backups only to authorized Backup Admins.</p> <p>Short-term retention can be\u00a0minutes\u00a0or\u00a0daily. Retention for\u00a0weekly,\u00a0monthly, or\u00a0yearly\u00a0backup points is referred to as\u00a0Long-term retention.</p> <p>Long-term retention can be:</p> <ul> <li>Planned (compliance requirements): If you know in advance that data is required years from the current time, use Long-term retention.</li> <li>Unplanned (on-demand requirement): If you don't know in advance, then you can use on-demand backup with specific custom retention settings (these custom retention settings aren't impacted by policy settings).</li> <li>On-demand backup with custom retention: If you need to take a backup not scheduled via backup policy, then you can use an on-demand backup. It can be useful for taking backups that don\u2019t fit your scheduled backup or for taking granular backup (for example, multiple IaaS VM backups per day since scheduled backup permits only one backup per day). It's important to note that the retention policy defined in scheduled policy doesn't apply to on-demand backups.</li> </ul> <p>You can also implement policy management to help with compliance. Azure Backup Policies within each vault define when the backups should be triggered and how long they need to be retained. You can also manage these policies and apply them across multiple items.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#does-azure-backup-simplify-monitoring-and-administration","title":"Does Azure Backup simplify monitoring and administration?","text":"<p>For monitoring and reporting, Azure Backup integrates with Log Analytics and provides the ability to see reports via Workbooks.</p> <p>Azure Backup provides in-built job monitoring for operations such as configuring backup, backing up, restoring, deleting backups, and so on. It's scoped to the vault and ideal for monitoring a single vault.</p> <p>If you need to monitor operational activities at scale, Backup Explorer provides an aggregated view of your entire backup estate, enabling detailed drill-down analysis and troubleshooting. It's a built-in Azure Monitor workbook that provides a single, central location to help you monitor operational activities across the entire backup estate on Azure, spanning tenants, locations, subscriptions, resource groups, and vaults.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#configure-azure-monitor","title":"Configure Azure Monitor","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction_1","title":"Introduction","text":"<p>Azure Monitor is a comprehensive solution that collects, analyzes, and responds to telemetry data from both on-premises and cloud environments.</p> <p>Suppose you work for a large e-commerce company that relies heavily on its online platform to generate revenue. During a major sales event, your website experiences a sudden increase in traffic, causing performance issues and impacting customer experience. As a result, customers are unable to complete their purchases. Poor customer experience led to lost sales and had a negative impact on the company's reputation. To prevent this from happening again, you need a tool that can monitor the availability and performance of your applications and services in real-time. With this tool you can quickly identify and resolve issues. Azure Monitor is the solution that can help you achieve this.</p> <p>In this module, you will learn about the features and usage cases of Azure Monitor. You learn how to configure and interpret metrics and logs. You review the different components and data types in Azure Monitor. You also learn how to access and query the activity log.</p> <p>The goal of this module is to equip you with the knowledge and skills to effectively use Azure Monitor.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#learning-objectives","title":"Learning objectives","text":"<p>In this module, you learn how to:</p> <ul> <li>Identify the features and usage cases for Azure Monitor.</li> <li>Configure and interpret metrics and logs.</li> <li>Identify the Azure Monitor components and data types.</li> <li>Configure the Azure Monitor activity Log.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#skills-measured","title":"Skills measured","text":"<p>The content in the module helps you prepare for\u00a0Exam AZ-104: Microsoft Azure Administrator.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#prerequisites","title":"Prerequisites","text":"<ul> <li>Familiarity with basic monitoring, evaluation, and reporting concepts.</li> <li>Knowledge of Azure resources and services that benefit from monitoring activities.</li> <li>Knowledge of the Azure portal so you can implement monitoring techniques.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#describe-azure-monitor-key-capabilities","title":"Describe Azure Monitor key capabilities","text":"<p>Azure Monitor provides you with a comprehensive solution for collecting, analyzing, and responding to telemetry data from your on-premises and cloud environments. The service features help you understand how your applications are performing. You can use Azure Monitor to proactively identify issues that affect your apps and resources, and take action to maximize their availability and performance.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-azure-monitor","title":"Things to know about Azure Monitor","text":"<p>Azure Monitor provides features and capabilities in three areas:</p> <ul> <li> <p>Monitor and visualize metrics: Azure Monitor gathers numerical metric values from your Azure resources according to your preferences. Azure Monitor offers different methods for viewing your metric data to help you understand the health, operation, and performance of your system.</p> </li> <li> <p>Query and analyze logs: Azure Monitor Logs (Log Analytics) generates activity logs, diagnostic logs, and telemetry information from your monitoring solutions. The service provides analytics queries that you can use to help with troubleshooting and visualizations of your log data.</p> </li> <li> <p>Set up alerts and actions: Azure Monitor lets you set up alerts for your gathered data to notify you when critical conditions arise. You can configure actions based on the alert conditions, and take automated corrective steps based on triggers from your metrics or logs.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#describe-azure-monitor-components","title":"Describe Azure Monitor components","text":"<p>Monitoring is the act of collecting and analyzing data. The data can be used to determine the performance, health, and availability of your business applications and the resources they depend on.</p> <p>An effective monitoring strategy helps you understand the detailed operation of the components of your applications. Monitoring also helps you increase your uptime by proactively notifying you of critical issues. You can then resolve the issues before they become severe.</p> <p>Azure includes multiple services that individually perform a specific role or task in the monitoring space. Together, these services deliver a comprehensive solution for collecting, analyzing, and acting on data from your applications and the Azure resources that support them. The services also work to monitor critical on-premises resources to provide a hybrid monitoring environment. Understanding the tools and data that are available is the first step in developing a complete monitoring strategy for your application.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-monitoring-with-azure","title":"Things to know about monitoring with Azure","text":"<p>Let's take a look at the various Azure components that support Azure Monitor capabilities. The following diagram provides a high-level view of how Azure and Azure Monitor work together to provide you with a robust monitoring and diagnostics solution.</p> <p></p> <ul> <li> <p>The monitoring and diagnostic services offered in Azure are divided into broad\u00a0categories\u00a0such as Core, Application, Infrastructure, and Shared Capabilities.</p> </li> <li> <p>Data stores\u00a0in Azure Monitor hold your metrics and logs.\u00a0Azure Monitor Metrics\u00a0and\u00a0Azure Monitor Logs\u00a0are the two base types of data used by the service.</p> </li> <li> <p>Various\u00a0monitoring sources\u00a0provide Azure Monitor with the metrics and logs data to analyze. These sources can include your Azure subscription and tenant, your Azure service instances, your Azure resources, data from your applications, and more.</p> </li> <li> <p>Azure Monitor Insights\u00a0performs different functions with the collected data, including analysis, alerting, and streaming to external systems.</p> <ul> <li> <p>Get insights: Access the Azure Application Insights extension to Azure Monitor to use the Application Performance Monitoring (APM) features. You can use APM tools to monitor your application performance and gather trace logging data. Application Insights are available for many Azure services, such as Azure Virtual Machines and Azure Virtual Machine Scale Sets, Azure Container Instances, Azure Cosmos DB, and Azure IoT Edge.</p> </li> <li> <p>Visualize: Utilize the many options in Azure Monitor for viewing and interpreting your gathered metrics and logs. You can use Power BI with the Azure Workbooks feature of Azure Monitor and access configurable dashboards and views.</p> </li> <li> <p>Analyze: Work with Azure Monitor Logs (Log Analytics) in the Azure portal to write log queries for your data. You can interactively analyze your log data by using Azure Monitor Metrics and the powerful analysis engine.</p> </li> <li> <p>Respond: Set up log alert rules in Azure Monitor to receive notifications about your application performance. You can configure the service to take automated action when the results of your queries and alerts match certain conditions or results.</p> </li> <li> <p>Integrate: Ingest and export log query results from the Azure CLI, Azure PowerShell cmdlets, and various APIs. Set up automated export of your log data to your Azure Storage account or Azure Event Hubs. Build workflows to retrieve your log data and copy to external locations with Azure Logic Apps.</p> </li> </ul> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#define-metrics-and-logs","title":"Define metrics and logs","text":"<p>All data collected by Azure Monitor fits into one of two fundamental types,\u00a0metrics and logs:</p> <p>Metrics\u00a0are numerical values that describe some aspect of a system at a particular point in time. Metrics are lightweight and capable of supporting near real-time scenarios.</p> <p>Logs\u00a0contain different kinds of data organized into records with different sets of properties for each type. Data like events and traces are stored as logs along with performance data so all the data can be combined for analysis.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-azure-monitor-metrics","title":"Things to know about Azure Monitor metrics","text":"<p>Let's examine how to work with Azure Monitor metrics in the Azure portal.</p> <ul> <li> <p>For many Azure resources, the metrics data collected by Azure Monitor is displayed on the\u00a0Overview\u00a0page for the resource in the Azure portal. Consider the overview for an Azure virtual machine that has several charts that show performance metrics.</p> </li> <li> <p>You can use Azure Monitor\u00a0metrics explorer\u00a0to view the metrics for your Azure services and resources.</p> </li> <li> <p>In the Azure portal, select any graph for a resource to open the associated metrics data in metrics explorer. The tool lets you chart the values of multiple metrics over time. You can work with the charts interactively or pin them to a dashboard to view them with other visualizations.</p> </li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-azure-monitor-logs","title":"Things to know about Azure Monitor Logs","text":"<p>You can also work with Azure Monitor Logs (Log Analytics) in the Azure portal. Let's review the details.</p> <ul> <li> <p>In the Azure portal, log data collected by Azure Monitor is stored in Log Analytics.</p> </li> <li> <p>Log Analytics includes a\u00a0rich query language\u00a0to help you quickly retrieve, consolidate, and analyze your collected data.</p> </li> <li> <p>You can work with Log Analytics to create and test queries. Use the query results to directly analyze the data, save your queries, visualize the data, and create alert rules.</p> </li> <li> <p>Azure Monitor uses a version of the\u00a0Data Explorer\u00a0query language. The language is suitable for simple log queries, but also includes advanced functionality like aggregations, joins, and smart analytics. You can quickly learn the query language by completing several available lessons. Particular guidance is provided for users familiar with SQL and Splunk.</p> </li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#identify-monitoring-data-and-tiers","title":"Identify monitoring data and tiers","text":"<p>Azure Monitor can collect data from various sources. You can think of the collected data as being categorized by tier. Tiers can include data collected from many sources, such as:</p> <ul> <li>Your application</li> <li>The operating system</li> <li>Services and resources used by your application</li> <li>The platform that supports your application</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-data-collection","title":"Things to know about data collection","text":"<p>Review the following details about how Azure Monitor collects different categories of data.</p> <ul> <li> <p>Azure Monitor begins collecting data as soon as you create your Azure subscription and add resources.</p> </li> <li> <p>When you create or modify resources, this data is stored in Azure Monitor activity logs.</p> </li> <li> <p>Performance data about resources, along with the amount of resources consumed, is stored as Azure Monitor metrics.</p> </li> <li> <p>Extend the data you're collecting by enabling diagnostics and adding Azure Monitor Agent to compute resources. By extending your data sources, you can collect data for the internal operation of the resources.</p> </li> <li> <p>Azure Monitor Agent also lets you configure different data sources to collect logs and metrics from Windows and Linux guest operating systems.</p> </li> <li> <p>Azure Monitor can collect log data from any REST client by using the Data Collector API. The Data Collector API lets you create custom monitoring scenarios and extend monitoring to resources that don't expose data through other sources.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#monitoring-data-tiers","title":"Monitoring data tiers","text":"<p>The following table summarizes the tiers of monitoring data that are collected by Azure Monitor.</p> <p>Expand table</p> Data tier Description Application The Application tier contains monitoring data about the performance and functionality of your application code. This data is collected regardless of your platform. Guest OS Monitoring data about the operating system on which your application is running is organized into the Guest OS tier. Your application can run in Azure, another cloud, or on-premises. Azure resource The Azure resource tier holds monitoring data about the operation of any Azure resource you utilize, including consumption details for the resource. Azure subscription The Azure subscription tier contains monitoring data about the operation and management of your Azure subscription. The tier also contains data about the health and operation of Azure itself. Azure tenant Data about the operation of your tenant-level Azure services, such as Microsoft Entra ID, is organized into the Azure tenant tier.","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#describe-activity-log-events","title":"Describe activity log events","text":"<p>The Azure Monitor activity log is a subscription log that provides insight into subscription-level events that occur in Azure. Events can include a range of data from Azure Resource Manager operational data to updates on Azure service health events.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#how-to-use-the-azure-activity-log","title":"How to use the Azure Activity Log","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-activity-logs","title":"Things to know about activity logs","text":"<p>Let's examine some details about working with activity logs in Azure Monitor.</p> <ul> <li> <p>You can use the information in activity logs to understand the status of resource operations and other relevant properties.</p> </li> <li> <p>Activity logs can help you determine the \"what, who, and when\" for any write operation (PUT, POST, DELETE) performed on resources in your subscription.</p> </li> <li> <p>Activity logs are kept for 90 days.</p> </li> <li> <p>You can query for any range of dates in an activity log, as long as the starting date isn't more than 90 days in the past.</p> </li> <li> <p>You can retrieve events from your activity logs by using the Azure portal, the Azure CLI, PowerShell cmdlets, and the Azure Monitor REST API.</p> </li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#business-scenarios","title":"Business scenarios","text":"<p>Activity logs can help you monitor your configuration and get details for many scenarios, such as:</p> <p>What operations happened on resources in my subscription?</p> <p>Who initiated the operations?</p> <p>When did the operations occur?</p> <p>What's the current status of the operations?</p> <p>What are the values of other properties that can help with my analysis of the resources and operations?</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#query-the-activity-log","title":"Query the activity log","text":"<p>In the Azure portal, you can filter your Azure Monitor activity logs so you can view specific information. The filters enable you to review only the activity log data that meets your criteria. You might set filters to review monitoring data about critical events for your primary subscription and production virtual machine during peak business hours.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-activity-log-filters","title":"Things to know about activity log filters","text":"<p>Let's review some of the filters you can set to control what data to review in your activity log:</p> <ul> <li> <p>Subscription: Show the data for one or more specified Azure subscription names.</p> </li> <li> <p>Timespan: Show data for a specified time by choosing the start and end time for events, such as a six-hour period.</p> </li> <li> <p>Event Severity: Show events at the selected severity levels, including\u00a0Informational,\u00a0Warning,\u00a0Error, or\u00a0Critical.</p> </li> <li> <p>Resource group: Show data for one or more specified resource groups within your specified subscriptions.</p> </li> <li> <p>Resource (name): Show data for the specified resources.</p> </li> <li> <p>Resource type: Show data for resources of a specified type, such as\u00a0<code>Microsoft.Compute/virtualmachines</code>.</p> </li> <li> <p>Operation name: Show data for a selected Azure Resource Manager operation, such as\u00a0<code>Microsoft.SQL/servers/Write</code>.</p> </li> <li> <p>Event initiated by: Show operation data for a specified user who performed the operation, referred to as the \"caller.\"</p> </li> </ul> <p>After you define a set of filters, you can pin the filter set to the Azure Monitor dashboard. You can also download your activity log search results as a CSV file.</p> <p>In addition to the filters, you can enter a text string in the\u00a0Search\u00a0box. Azure Monitor tries to match your search string against data returned for all fields in all events that corresponds to your filter settings.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-event-categories","title":"Things to know about event categories","text":"<p>The following table summarizes the categories of events that you can review in your activity logs. The information displayed for events is based on your other filter settings.</p> <p>Expand table</p> Event category Event data Examples Administrative All create, update, delete, and action operations performed through Azure Resource Manager, and any changes to role-based access control (RBAC) in your filtered subscriptions <code>create virtual machine</code> <code>delete network security group</code> Service Health All service health events for Azure services and resources connected with your filtered subscriptions, including\u00a0Action Required,\u00a0Assisted Recovery,\u00a0Incident,\u00a0Maintenance,\u00a0Information, or\u00a0Security <code>SQL Azure in East US is experiencing downtime</code> <code>Azure SQL Data Warehouse Scheduled Maintence Complete</code> Resource Health All resource health events for your filtered Azure resources, including\u00a0Available,\u00a0Unavailable,\u00a0Degraded, or\u00a0Unknown, and identified as\u00a0Platform Initiated\u00a0or\u00a0User Initiate <code>Virtual Machine health status changed to unavailable</code> <code>Web App health status changed to available</code> Alert All activations of Azure alerts for your filtered subscriptions and resources <code>CPU % on devVM001 has been over 80 for the past 5 minutes</code> <code>Disk read LessThan 100000 in the last 5 minutes</code> Autoscale All events related to the operation of the autoscale engine based on any autoscale settings defined for your filtered subscriptions <code>Autoscale scale up action failed</code> Recommendation Recommendation events for certain Azure resource types, such as web sites and SQL servers, based on your filtered subscriptions and resources Recommendations for how to better utilize your resources Security All alerts generated by Microsoft Defender for Cloud affecting your filtered subscriptions and resources <code>Suspicious double extension file executed</code> Policy All effect action operations performed by Azure Policy for your filtered subscriptions and resources, where every action taken by Azure Policy is modeled as an operation on a resource <code>Audit</code>\u00a0and\u00a0<code>Deny</code>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#interactive-lab-simulation","title":"Interactive lab simulation","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#lab-scenario","title":"Lab scenario","text":"<p>Your organization wants insight into the performance and configuration of Azure resources. As the Azure Administrator you need to:</p> <ul> <li>Explore Azure virtual machine monitoring capabilities, including available metrics.</li> <li>Explore alerts and notification features.</li> <li>Review logs by using Azure Monitor Logs (Log Analytics) queries.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#architecture-diagram","title":"Architecture diagram","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#objectives","title":"Objectives","text":"<ul> <li>Task 1: Provision the lab environment.<ul> <li>Review an\u00a0Azure Resource Manager (ARM) template.</li> <li>Use the ARM template to deploy a virtual machine to use to test monitoring scenarios.</li> </ul> </li> <li>Task 2: Register the Microsoft Insights and Microsoft Alerts Management resource providers.<ul> <li>Create a Log Analytics workspace in the same region as the virtual machines.</li> <li>Create an Azure Automation Account and associate it with the Azure Monitor Logs (Log Analytics) workspace.</li> <li>Enable update management.</li> </ul> </li> <li>Task 3: Create and configure an Azure Monitor Logs (Log Analytics) workspace and Azure Automation-based solutions.<ul> <li>Review Azure virtual machine monitoring options.</li> <li>Review the list of available metrics.</li> </ul> </li> <li>Task 4: Review default monitoring settings of Azure virtual machines.</li> <li>Task 5: Configure Azure virtual machine diagnostic settings.<ul> <li>Review the Azure virtual machine monitoring settings and enable guest-level monitoring.</li> <li>Enable Azure Monitor Agent and available metrics.</li> </ul> </li> <li>Task 6: Review Azure Monitor functionality.<ul> <li>Configure Azure Monitor metrics.</li> <li>Create an alert rule based on average percentage CPU.</li> <li>Configure notifications for an action group.</li> <li>Trigger increased CPU utilization and review alert notifications.</li> </ul> </li> <li>Task 7: Review Azure Monitor Logs (Log Analytics) functionality.<ul> <li>Create a log query to chart the virtual machine's available memory over the last hour.</li> <li>Run the log query and preview the data.</li> </ul> </li> </ul> <p>Note</p> <p>Select the thumbnail image to start the lab simulation. When you're done, be sure to return to this page so you can continue learning.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#configure-log-analytics","title":"Configure Log Analytics","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction_2","title":"Introduction","text":"<p>Log Analytics is a tool in Azure Monitor that allows you to edit and run log queries for data collected in Azure Monitor Logs. It offers query features and tools, supports the Kusto Query Language (KQL), and allows for detailed analysis and problem-solving.</p> <p>Imagine you're an Azure Administrator working for a large e-commerce company. Your company recently experienced a major security breach, and you need to investigate the root cause and prevent future incidents. You have access to logs from various Azure services, but manually analyzing them would be time-consuming and inefficient.</p> <p>By using Log Analytics, you can easily query and analyze the logs to identify any suspicious activities, track changes, and ensure compliance with security standards. With Log Analytics, you can quickly assess update requirements and time-to-complete, track changes, and identify access issues in your systems. It helps meet strict SLAs for businesses and provides a single interface for analyzing data from multiple sources.</p> <p>The goal of this module is to provide you with the knowledge and skills to effectively use Log Analytics in Azure Monitor.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#learning-objectives_1","title":"Learning objectives","text":"<p>In this module, you learn how to:</p> <ul> <li>Identify the features and usage cases for Log Analytics in Azure Monitor.</li> <li>Structure and create a Log Analytics workspace in the Azure portal.</li> <li>Use KQL to query a Log Analytics workspace and review results.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#skills-measured_1","title":"Skills measured","text":"<p>The content in the module helps you prepare for\u00a0Exam AZ-104: Microsoft Azure Administrator.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#prerequisites_1","title":"Prerequisites","text":"<ul> <li>Working knowledge of Azure Monitor including data sources and collected data.</li> <li>Experience with the Azure portal including navigating and locating resources.</li> <li>Familiarity with structuring and executing data queries.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#determine-log-analytics-uses","title":"Determine Log Analytics uses","text":"<p>Log Analytics is a tool for Azure Monitor that's available in the Azure portal. You can use Log Analytics to edit and run log queries for the data collected in Azure Monitor Logs. Log queries help you to search for patterns and identify issues.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-log-analytics","title":"Things to know about Log Analytics","text":"<p>Let's examine some characteristics of Log Analytics in Azure Monitor.</p> <ul> <li> <p>Log Analytics in Azure Monitor offers query features and tools that help you answer virtually any question about your monitored configuration.</p> </li> <li> <p>Log Analytics supports the Kusto Query Language (KQL). You can create simple or complex queries with KQL, including:</p> <ul> <li>Search and sort by value, time, property state, and more</li> <li>Join data from multiple tables</li> <li>Aggregate large sets of data</li> <li>Perform intricate operations with minimal code</li> <li>When your Azure Monitor Logs contain sufficient collected data, and you understand how to construct the appropriate query, you can use Log Analytics to complete detailed analysis and problem solving.</li> </ul> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-consider-when-using-log-analytics","title":"Things to consider when using Log Analytics","text":"<p>Some features in Azure Monitor, such as insights and solutions, process log data without exposing you to the underlying queries. To use other Azure Monitor features, you need to understand how to construct queries and apply them to interactively analyze data in Azure Monitor Logs. The following business scenarios showcase the advantages of querying Azure Monitor Logs with Log Analytics.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#business-scenario-assess-update-requirements-and-time-to-complete","title":"Business scenario: Assess update requirements and time-to-complete","text":"<p>An important daily task for IT admins is to assess system update requirements and plan for configuration patches. Accurate scheduling is critical because the patching process relates to SLAs to the business and can negatively affect business functions.</p> <p>In the past, administrators had to schedule a patch update with only limited knowledge of how long it might take to complete the process. With an Azure subscription, admins can access benefits of the Microsoft Azure platform. Azure collects data from all customers performing patches. Azure uses the gathered data to provide an average patching time for specific updates.</p> <p>This use of \"crowd-sourced\" data is unique to cloud systems. It's a great example of how Log Analytics in Azure Monitor can you help meet strict SLAs for your business.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#business-scenario-track-changes-and-identify-access-issues","title":"Business scenario: Track changes and identify access issues","text":"<p>Troubleshooting an operational incident is a complex process that requires access to multiple data streams. By monitoring your systems from the Azure platform, you can easily perform analysis from multiple angles. You have access to data from a wide variety of sources through a single interface for correlation of information.</p> <p>By tracking changes across the Azure environment, Log Analytics in Azure Monitor can help you easily identify common issues, such as:</p> <ul> <li>Abnormal behavior from a specific account</li> <li>Users installing unapproved software</li> <li>Unexpected system reboots or shutdowns</li> <li>Evidence of security breaches</li> <li>Specific problems in loosely coupled applications</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-a-log-analytics-workspace","title":"Create a Log Analytics workspace","text":"<p>When you capture logs and data in Azure Monitor, Azure stores the collected information in a Log Analytics workspace. Your Log Analytics workspace is the basic management environment for Azure Monitor Logs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#how-to-define-your-log-analytics-scope","title":"How to define your Log Analytics scope","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-the-log-analytics-workspace","title":"Things to know about the Log Analytics workspace","text":"<p>To get started with Log Analytics in Azure Monitor, you need to create your workspace. Each workspace has a unique workspace ID and resource ID. After you create your workspace, you configure your data sources and solutions to store their data in your workspace.</p> <p></p> <p>To create your Log Analytics workspace, configure the following parameters:</p> <ul> <li> <p>Name: Provide a name for your new Log Analytics workspace. The name for your workspace must be unique within your resource group.</p> </li> <li> <p>Subscription: Specify the Azure Subscription to associate with your workspace.</p> </li> <li> <p>Resource Group: Specify the resource group to associate with your workspace. You can choose an existing resource group or create a new one. The resource group must contain at least one Azure Virtual Machines instance.</p> </li> <li> <p>Region: Select the region where you deploy your virtual machines.</p> <p>Note</p> <p>The region must support Log Analytics. You can review the\u00a0regions that support Log Analytics. In the\u00a0Search for a product\u00a0box, enter \"Azure Monitor.\"</p> </li> <li> <p>Pricing: The default pricing tier for a new workspace is\u00a0pay-as-you-go. Charges incur only after you start collecting data.</p> <p>Each Log Analytics workspace in Azure Monitor can have a different pricing tier. You can change the pricing tier for a workspace and also track the changes.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-kusto-queries","title":"Create Kusto queries","text":"<p>Log Analytics in Azure Monitor supports the Kusto Query Language (KQL). The KQL syntax helps you quickly and easily create simple or complex queries to retrieve and consolidate your monitoring data in the repository.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#write-kusto-query-language-log-queries-for-azure-monitor","title":"Write Kusto Query Language log queries for Azure Monitor","text":"<p>Watch the following video to learn how to write log queries with Log Analytics in Azure Monitor. The video covers the following concepts:</p> <ul> <li>View table data in the Azure Monitor Logs repository</li> <li>Create simple and complex queries</li> <li>Filter and summarize search results</li> <li>Add visualizations for search results</li> </ul> <p>In the next unit, we take a closer look at how to structure a log query.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-consider-when-using-log-queries","title":"Things to consider when using log queries","text":"<p>Here are some of the many things you can accomplish with log queries in Log Analytics:</p> <ul> <li> <p>Create and save searches of your data stored in the Azure Monitor Logs repository.</p> </li> <li> <p>Use your saved log searches to directly analyze your data in the Azure portal.</p> </li> <li> <p>Configure your saved log searches to run automatically.</p> </li> <li> <p>Configure your saved log searches to produce notification alerts.</p> </li> <li> <p>Add visualizations for your saved log searches to see graphical views of your environment health.</p> </li> <li> <p>Export your data from the repository into analytical tools like Power BI or Excel.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#structure-log-analytics-queries","title":"Structure Log Analytics queries","text":"<p>Administrators build Log Analytics queries from data stored in dedicated tables in a Log Analytics workspace. Some common dedicated tables include Event, Syslog, Heartbeat, and Alert. When you build a Kusto Query Language (KQL) query, you begin by determining which tables in the Azure Monitor Logs repository have the data you're looking for.</p> <p>The following illustration highlights how KQL queries use the dedicated table data for your monitored services and resources.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-kql-query-structure","title":"Things to know about KQL query structure","text":"<p>Let's take a closer look at dedicated table data and how to structure a KQL log query.</p> <ul> <li> <p>Each of your selected data sources and solution stores its data in dedicated tables in your Log Analytics workspace.</p> </li> <li> <p>Documentation for each data source and solution includes the name of the data type that it creates and a description of each of its properties.</p> </li> <li> <p>The basic structure of a query is a source table followed by a series of commands (referred to as\u00a0operators).</p> </li> <li> <p>A query can have a chain of multiple operators to refine your data and perform advanced functions.</p> </li> <li> <p>Each operator in a query chain begins with a pipe character\u00a0<code>|</code>.</p> </li> <li> <p>Many queries require data from a single table only, but other queries can use various options and include data from multiple tables.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#kql-log-query-examples","title":"KQL log query examples","text":"<p>Let's review some common KQL log query operators and example syntax.</p> <p>We can build queries to search for data in the\u00a0<code>StormEvent</code>\u00a0table that has five entries:</p> <p>Expand table</p> type event severity start duration region <code>Water</code> <code>Freezing rain</code> <code>1</code> <code>6:00 AM 01-27-2023</code> <code>3 hours</code> <code>1, 2</code> <code>Wind</code> <code>High winds</code> <code>1</code> <code>8:00 AM 01-27-2023</code> <code>12 hours</code> <code>1, 2, 4, 5</code> <code>Temperature</code> <code>Below freezing</code> <code>2</code> <code>11:00 PM 01-26-2023</code> <code>10 hours</code> <code>1, 2, 4, 5</code> <code>Water</code> <code>Snow</code> <code>3</code> <code>4:00 PM 01-26-2023</code> <code>10 hours</code> <code>1, 2, 4, 5</code> <code>Water</code> <code>Flood warning</code> <code>2</code> <code>9:00 AM 01-26-2023</code> <code>10 hours</code> <code>3</code> <p>To find other operators and examples, review:\u00a0Analyze monitoring data with Kusto Query Language - Training | Microsoft Learn.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#count-number-of-items","title":"Count number of items","text":"<p>Use the\u00a0<code>count</code>\u00a0operator to discover the number of records in an input record set.</p> <p>The following example returns the number of records in the\u00a0<code>StormEvent</code>\u00a0table. The query results reveal the\u00a0<code>StormEvent</code>\u00a0table has five entries.</p> <p>KustoCopy</p> <pre><code>StormEvent | count\n</code></pre> <p>Query results:</p> <p>Expand table</p> count <code>5</code>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#return-first-number-of-items","title":"Return first number of items","text":"<p>Use the\u00a0<code>top</code>\u00a0operator to see the first N records of your input record set, sorted by your specified columns. The columns correspond to data properties defined in the dedicated table.</p> <p>The following example returns the first three data records for\u00a0<code>StormEvent</code>. The results table shows the storm\u00a0<code>event</code>\u00a0name, the severity, and the forecasted duration.</p> <p>KustoCopy</p> <pre><code>StormEvent | top 3 by event severity duration\n</code></pre> <p>Query results:</p> <p>Expand table</p> event severity duration <code>Freezing rain</code> <code>1</code> <code>3 hours</code> <code>High winds</code> <code>1</code> <code>12 hours</code> <code>Below freezing</code> <code>2</code> <code>10 hours</code>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#find-matching-items","title":"Find matching items","text":"<p>Use the\u00a0<code>where</code>\u00a0operator to filter your table to the subset of rows that match the supplied predicate value. The predicate value indicates what to search for in the table, as in\u00a0<code>where==\"find-this\"</code>.</p> <p>The following example filters the data records for\u00a0<code>StormEvent</code>\u00a0to use only records that match \"snow.\"</p> <p>KustoCopy</p> <pre><code>StormEvent | where event==\"snow\"\n</code></pre> <p>Your query filters to one row in the\u00a0<code>StormEvent</code>\u00a0table:</p> <p>Expand table</p> type event severity start duration region <code>Water</code> <code>Snow</code> <code>3</code> <code>4:00 PM 01-26-2023</code> <code>10 hours</code> <code>1, 2, 4, 5</code>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#configure-network-watcher","title":"Configure Network Watcher","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction_3","title":"Introduction","text":"<p>Azure Network Watcher is a powerful tool that allows you to monitor, diagnose, and manage resources in an Azure virtual network.</p> <p>Imagine you're an IT administrator for a large e-commerce company. Your company relies heavily on its Azure virtual network to host its website and handle customer transactions. One day, you receive reports from customers that they're unable to access the website or complete their purchases. You need to quickly identify the cause of the connectivity issues and resolve them to minimize the impact on your business.</p> <p>Your organization plans to use Network Watcher. Network Watcher's monitoring and diagnostic capabilities let you easily pinpoint the root cause of the problem and take appropriate actions. By using features such as IP flow verification, next hop analysis, and connection troubleshooting, you can ensure that your virtual network is functioning optimally.</p> <p>In this module, you learn about the various features and use cases of Azure Network Watcher. The topics covered include IP flow verification, next hop analysis, and the topology tool. The module guides you on how to diagnose network configuration issues, such as broken security rules.</p> <p>The goal of this module is to provide you with a comprehensive understanding of Azure Network Watcher and its capabilities. By the end of this module, you effectively monitor, diagnose, and manage your Azure virtual network using Network Watcher.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#describe-azure-network-watcher-features","title":"Describe Azure Network Watcher features","text":"<p>Azure Network Watcher provides tools to monitor, diagnose, view metrics, and enable or disable logs for resources in an Azure virtual network. Network Watcher is a regional service that enables you to monitor and diagnose conditions at a network scenario level.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-network-watcher","title":"Things to know about Network Watcher","text":"<p>Let's review some of the prominent features of Network Watcher.</p> <p>Expand table</p> Feature Description Scenarios IP flow verify Quickly diagnose connectivity issues from or to the internet, and from or to your on-premises environment. Identify if a security rule blocks ingress or egress traffic to or from a virtual machine Troubleshoot issues to determine if other exploration is required Next hop View the next connection point (or\u00a0next hop) in your network route, and analyze your network routing configuration. Determine if there's a next hop, and view the next hop target, type, and route table Confirm traffic reaches an intended target destination VPN troubleshoot Diagnose and troubleshoot the health of your virtual network gateway or connection with gathered data. View connection statistics, CPU and memory information, IKE security errors, packet drops, and buffers and events. View summary diagnostics in the Azure portal Review detailed diagnostics in generated log files stored in your Azure storage account Simultaneously troubleshoot multiple gateways or connections NSG diagnostics Use flow logs to map IP traffic through a network security group (NSG). A common implementation for NSG flow logs is to meet security compliance regulations and auditing requirements. Define prescriptive NSG rules for your organization, and conduct periodic compliance audits Compare your prescriptive NSG rules against the effective rules for each virtual machine in your network Connection troubleshoot Azure Network Watcher Connection Troubleshoot is a more recent addition to the Network Watcher suite of networking tools and capabilities. Check a direct TCP or ICMP connection from a virtual machine, application gateway, or Azure Bastion host to a virtual machine. Troubleshoot your network performance and connectivity issues in Azure Troubleshoot connection issues for a virtual machine, application gateway, or Azure Bastion host <p>Note</p> <p>To use Network Watcher, you must be an Owner, Contributor, or Network Contributor. If you create a custom role, the role must be able to read, write, and delete the Network Watcher service.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-consider-when-using-network-watcher","title":"Things to consider when using Network Watcher","text":"<p>Azure Network Watcher supports many Azure monitoring tasks and scenarios. As you review these features, think about how Network Watcher can support your Azure monitoring requirements.</p> <ul> <li> <p>Consider remote monitoring. Automate remote network monitoring with packet capture. You can monitor and diagnose networking issues without logging in to your virtual machines.</p> </li> <li> <p>Consider alert notifications. Set alerts to trigger packet capture, and access real-time performance information at the packet level. When you observe an issue, you can investigate in detail for better diagnoses.</p> </li> <li> <p>Consider NSG flow log diagnosis. Use NSG flow logs to gain insight into your network traffic. Build a deeper understanding of your network traffic pattern by using NSG flow logs. Information provided by flow logs helps you gather data for compliance, auditing, and monitoring your network security profile.</p> </li> <li> <p>Consider log analysis. Diagnose your most common Azure VPN Gateway and connections issues. You can identify issues and use the generated detailed logs to assist your analysis.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#review-ip-flow-verify-diagnostics","title":"Review IP flow verify diagnostics","text":"<p>The\u00a0IP flow verify\u00a0feature in Azure Network Watcher checks connectivity from or to the internet, and from or to your on-premises environment. This feature helps you identify if a security rule is blocking traffic to or from your virtual machine or the internet.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-ip-flow-verify","title":"Things to know about IP flow verify","text":"<p>Let's examine the configuration details and functionality of the IP flow verify feature in Azure Network Watcher.</p> <ul> <li> <p>You configure the IP flow verify feature with the following properties in the Azure portal:</p> <ul> <li>Virtual machine and network interface</li> <li>Local (source) port number</li> <li>Remote (destination) IP address, and remote port number</li> <li>Communication protocol (TCP or UDP)</li> <li>Traffic direction (Inbound or Outbound)</li> <li>The feature tests communication for a target virtual machine with associated network security group (NSG) rules by running inbound and outbound packets to and from the machine.</li> </ul> </li> <li> <p>After the test runs complete, the feature informs you whether communication with the machine succeeds (allows access) or fails (denies access).</p> </li> <li> <p>If the target machine denies the packet because of an NSG, the feature returns the name of the controlling security rule.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-consider-when-using-ip-flow-verify","title":"Things to consider when using IP flow verify","text":"<p>The IP flow verify feature is ideal for helping to ensure correct application of your security rules.</p> <p>When you deploy a virtual machine, Azure applies several default security rules to your machine. The security rules allow or deny traffic to or from your virtual machine. You can override Azure's default rules or create other rules.</p> <p>At some point, your virtual machine might be unable to communicate with other resources because of a security rule. You can use the IP flow verify feature to troubleshoot your NSG rules.</p> <p>If test runs fail, but the IP flow verify feature doesn't indicate the issue is related to your NSG rules, you need to explore other areas, such as firewall restrictions.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#review-next-hop-diagnostics","title":"Review next hop diagnostics","text":"<p>The\u00a0next hop\u00a0feature in Azure Network Watcher checks if traffic is being directed to the intended destination. This feature lets you view the next connection point (or\u00a0next hop) in your network route, and helps you verify a correct network configuration.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-next-hop","title":"Things to know about next hop","text":"<p>Let's review the configuration properties and summary of the next hop feature in Azure Network Watcher.</p> <ul> <li> <p>You configure the next hop feature with the following properties in the Azure portal:</p> <ul> <li>Your subscription and resource group</li> <li>Virtual machine and network interface</li> <li>Source IP address</li> <li>Destination IP address (If you want to confirm a specified target is reachable)</li> <li>The feature tests the next connection point in your network route configuration.</li> </ul> </li> <li> <p>The next hop test returns three items:</p> <ul> <li>Next hop type</li> <li>IP address of the next hop (If available)</li> <li>Route table for the next hop (If available)</li> <li>Examples of a next hop are\u00a0Internet,\u00a0Virtual Network, and\u00a0Virtual Network Service Endpoint.</li> </ul> </li> <li> <p>If the next hop is a user-defined route (UDR), the process returns the UDR route. Otherwise, next hop returns the system route.</p> </li> <li> <p>If the next hop is of type\u00a0None, there might be a valid system route to the destination IP address, but no next hop exists to route the traffic to the target.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-consider-when-using-next-hop","title":"Things to consider when using next hop","text":"<p>The next hop feature is ideal for identifying unresponsive virtual machines or broken routes in your network.</p> <p>When you create a virtual network, Azure creates several default outbound routes for network traffic. Outbound traffic from all resources (such as virtual machines) deployed in the virtual network is routed based on Azure's default routes. You can override Azure's default routes or create other routes.</p> <p>You might find that a virtual machine can no longer communicate with other resources connected by a specific route. You can use the next hop feature to examine a specific source and destination IP address in your configuration.</p> <p>Next hop tests the communication between the source and destination, and reports the type of next hop in the traffic route. You can then remove, change, or add a route, to resolve routing issues.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#visualize-the-network-topology","title":"Visualize the network topology","text":"<p>Administrators sometimes need to troubleshoot virtual networks that they didn't help to create. They might not be fully aware of all the aspects of the infrastructure and configuration.</p> <p>Azure Network Watcher provides a network monitoring\u00a0topology\u00a0tool to help administrators visualize and understand infrastructure. The following image shows an example topology diagram for a virtual network in Network Watcher.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#things-to-know-about-the-topology-tool","title":"Things to know about the topology tool","text":"<p>Review the following characteristics of the network topology capability in Azure Network Watcher.</p> <ul> <li> <p>The Network Watcher Topology tool generates a visual diagram of the resources in a virtual network.</p> </li> <li> <p>The graphical display shows the resources in the network, their interconnections, and their relationships with each other.</p> </li> <li> <p>You can view subnets, virtual machines, network interfaces, public IP addresses, network security groups, route tables, and more.</p> </li> <li> <p>To generate a topology, you need an Azure Network Watcher instance in the same region as the virtual network.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#improve-incident-response-with-azure-monitor-alerts","title":"Improve incident response with Azure Monitor alerts","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction_4","title":"Introduction","text":"<p>Microsoft Azure provides a robust alerting and monitoring solution called Azure Monitor. You can use Azure Monitor to configure notifications and alerts for your key systems and applications. These alerts ensure that the correct team knows when a problem arises.</p> <p>You work for a large shipping company that recently deployed several web applications to the Azure platform. Due to a configuration error, the customer-facing order tracker was offline. The issue wasn't identified until customers started complaining that they couldn't track their orders. As a consequence, customer satisfaction with your service dropped.</p> <p>As your company's Azure solution architect, you need to find a solution that detects problems in your environments in real time. The solution should notify the correct team so it can resolve any problems before your customers notice.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#learning-objectives_2","title":"Learning objectives","text":"<p>In this module, you'll:</p> <ul> <li>Explore alerts by using Azure Monitor.</li> <li>Understand when to use metric, log, and activity log events.</li> <li>Create and use metric alerts, log search alerts, and activity log alerts.</li> <li>Use action groups to determine what kind of notifications are sent and to whom.</li> <li>Learn how to use alert-processing rules to override the normal behavior of action groups when needed.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#prerequisites_2","title":"Prerequisites","text":"<ul> <li>Knowledge of Azure Monitor</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#explore-the-different-alert-types-that-azure-monitor-supports","title":"Explore the different alert types that Azure Monitor supports","text":"<p>Azure Monitor is a powerful reporting and analytics tool. You can use it for insights into the behavior and running of your environment and applications. You can then respond proactively to faults in your system.</p> <p>After the downtime that your customers faced, you set up monitoring on your key resources in Azure. With the monitoring in place, you want to make sure the right people are being alerted at the right level.</p> <p>In this unit, you learn how Azure Monitor receives resource data, what makes up an alert, and how and when to use an alert. Finally, you learn how to create and manage your own alerts.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#data-types-in-azure-monitor","title":"Data types in Azure Monitor","text":"<p>Azure Monitor receives data from target resources like applications, operating systems, Azure resources, Azure subscriptions, and Azure tenants. The nature of the resource defines which data types are available. A data type can be a\u00a0metric, a\u00a0log, or both a metric and a log:</p> <ul> <li>The focus for\u00a0metric-based data types is the numerical time-sensitive values that represent some aspect of the target resource.</li> <li>The focus for\u00a0log-based data types is the querying of content data held in structured, record-based log files that are relevant to the target resource.</li> </ul> <p></p> <p>There are three signal types that you can use to monitor your environment:</p> <ul> <li>Metric\u00a0alerts provide an alert trigger when a specified threshold is exceeded. For example, a metric alert can notify you when CPU usage is greater than 95 percent.</li> <li>Activity log\u00a0alerts notify you when Azure resources change state. For example, an activity log alert can notify you when a resource is deleted.</li> <li>Log\u00a0alerts are based on things written to log files. For example, a log search alert can notify you when a web server returns a particular number of 404 or 500 responses.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#composition-of-an-alert-rule","title":"Composition of an alert rule","text":"<p>Every alert or notification available in Azure Monitor is the product of a rule. Some of these rules are built into the Azure platform. You can use alert rules to create custom alerts and notifications. No matter which target resource or data source you use, the composition of an alert rule remains the same.</p> <ul> <li>RESOURCE<ul> <li>The\u00a0target resource\u00a0for the alert rule. You can assign multiple target resources to a single alert rule. The type of resource defines the available signal types.</li> </ul> </li> <li>CONDITION<ul> <li>The\u00a0signal type\u00a0used to assess the rule. The signal type can be a metric, an activity log, or logs. There are others, but this module doesn't cover them.</li> <li>The\u00a0alert logic\u00a0applied to the data that's being supplied via the signal type. The structure of the alert logic changes depending on the signal type.</li> </ul> </li> <li>ACTIONS<ul> <li>The\u00a0action, like sending an email, sending a Short Message Service (SMS) message, or using a webhook.</li> <li>An\u00a0action group, which typically contains a unique set of recipients for the action.</li> </ul> </li> <li>ALERT DETAILS<ul> <li>An\u00a0alert name\u00a0and an\u00a0alert description\u00a0that specify the alert's purpose.</li> <li>The\u00a0severity\u00a0of the alert if the criteria or logic test evaluates\u00a0<code>true</code>. The five severity levels are:<ul> <li>0: Critical</li> <li>1: Error</li> <li>2: Warning</li> <li>3: Informational</li> <li>4: Verbose</li> </ul> </li> </ul> </li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#scope-of-alert-rules","title":"Scope of alert rules","text":"<p>You can get monitoring data from across most of the Azure services and report on it by using the Azure Monitor pipeline. In the Azure Monitor pipeline, you can create alert rules for these items and more:</p> <ul> <li>Metric values</li> <li>Log search queries</li> <li>Activity log events</li> <li>Health of the underlying Azure platform</li> <li>Tests for website availability</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#manage-alert-rules","title":"Manage alert rules","text":"<p>Not every alert rule that you create needs to run forever. With Azure Monitor, you can specify one or more alert rules and enable or disable them, as needed.</p> <p>As an Azure solution architect, you want to use Azure Monitor to enable tightly focused and specific alerts before any application change. Then, disable the alerts after a successful deployment.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#alert-summary-view","title":"Alert summary view","text":"<p>The alert page shows a summary of all alerts. You can apply filters to the view by using one or more of the following categories: subscriptions, alert condition, severity, or time ranges. The view includes only alerts that match these criteria.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#alert-condition","title":"Alert condition","text":"<p>The system sets the alert condition.</p> <ul> <li>When an alert fires, the alert's monitor condition is set to\u00a0Fired.</li> <li>After the underlying condition that caused the alert to fire clears, the monitor condition is set to\u00a0Resolved.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-metric-alerts-for-alerts-about-performance-issues-in-your-azure-environment","title":"Use metric alerts for alerts about performance issues in your Azure environment","text":"<p>Azure Monitor can use thresholds to monitor specific resources. In an organization, it's far more useful to be notified when the free disk space on a server is less than five percent, instead of being alerted every time a file is saved.</p> <p>As a solution architect, you want to implement regular threshold monitoring for many of your target resources and instances. Monitoring helps to head off potential issues before they can affect your customers.</p> <p>In this unit, you investigate the different kinds of metric alerts that Azure Monitor supports.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#when-would-you-use-metric-alerts","title":"When would you use metric alerts?","text":"<p>In Azure Monitor, you can use metric alerts to achieve regular threshold monitoring of Azure resources. Azure Monitor runs metric alert trigger conditions at regular intervals. When the evaluation is true, Azure Monitor sends a notification. Metric alerts are stateful, and Azure Monitor sends a notification only when the prerequisite conditions are met.</p> <p>Metric alerts can be useful if, for instance, you need to know when your server CPU utilization is reaching a critical threshold of 90 percent. You can receive alerts when your database storage is getting too low, or when network latency is about to reach unacceptable levels.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#composition-of-a-metric-alert","title":"Composition of a metric alert","text":"<p>As you learned in the previous unit, all alerts are the product of the rules that govern them. For metric alerts, there's another factor to define: the condition type. It can be static or dynamic.</p> <p>You must define the type of statistical analysis to be used with either static or dynamic metric alerts. Example types are minimum, maximum, average, and total. In this example, you define the period of data to be assessed: the last 10 minutes. Finally, you set the frequency by which the alert conditions are checked: every two minutes.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-static-threshold-metric-alerts","title":"Use static threshold metric alerts","text":"<p>Static metric alerts are based on simple static conditions and thresholds that you define. With static metrics, you specify the threshold used to trigger the alert or notification.</p> <p>In the previously defined scenario, a static alert with a threshold of 85 percent CPU utilization checks the rule every two minutes. It evaluates the last 10 minutes of CPU utilization data to assess if it rises above the threshold. If the evaluation is true, the alert triggers the actions associated with the action group.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-dynamic-threshold-metric-alerts","title":"Use dynamic threshold metric alerts","text":"<p>Dynamic metric alerts use machine-learning tools that Azure provides to automatically improve the accuracy of the thresholds defined by the initial rule.</p> <p>There's no hard threshold in dynamic metrics. However, you need to define two more parameters:</p> <ul> <li> <p>The\u00a0look-back period\u00a0defines how many previous periods need to be evaluated. For example, if you set the look-back period to three, then in the example used here, the assessed data range would be 30 minutes (three sets of 10 minutes).</p> </li> <li> <p>The\u00a0number of violations\u00a0expresses how many times the logic condition has to deviate from the expected behavior before the alert rule fires a notification. In this example, if you set the number of violations to two, the alert would be triggered after two deviations from the calculated threshold.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#understand-dimensions","title":"Understand dimensions","text":"<p>Until now, the assessed metric alerts we discussed, focused on a single target instance. Azure Monitor supports dimensions, which enable monitoring data to be supplied from multiple target instances.</p> <p>You can use dimensions to define one metric alert rule and apply it to multiple related instances. For example, you can monitor CPU utilization across all the servers running your app. You can then receive an individual notification for each server instance when the rule conditions are triggered.</p> <p>You can define the dimensions by naming each target instance specifically, or you can define the dimensions by using the asterisk (*) wildcard, which uses all available instances.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#scale-metric-alerts","title":"Scale metric alerts","text":"<p>Azure Monitor supports creating metric alerts that, like dimensions, monitor multiple resources. Scaling is currently limited to Azure virtual machines. However, a single metric alert can monitor resources in one Azure region.</p> <p>Creating scaling metric alert rules to monitor multiple resources is no different than creating any other metric alert rule; you just select all the resources that you want to monitor.</p> <p>Like dimensions, a scaling metric alert is individual to the resource that triggered it.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#exercise-use-metric-alerts-to-alert-on-performance-issues-in-your-azure-environment","title":"Exercise - Use metric alerts to alert on performance issues in your Azure environment","text":"<p>The shipping company you work for wants to avoid any future issues with updates to its applications on the Azure platform. To improve the alert capabilities in Azure, you made the choice to use Azure metric alerts.</p> <p>In this exercise, you create a Linux virtual machine (VM). This VM runs an app that runs the CPU at 100 percent utilization. You create monitoring rules in the Azure portal and in the Azure CLI to alert you about high CPU usage.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-the-vm","title":"Create the VM","text":"<p>This VM runs a specific configuration that stresses the CPU and generates the metric monitoring data needed to trigger an alert.</p> <ol> <li> <p>Start by creating the configuration script. To create the\u00a0<code>cloud-init.txt</code>\u00a0file with the configuration for the VM, run the following command in Azure Cloud Shell:</p> <p>BashCopy</p> <pre><code>cat &lt;&lt;EOF &gt; cloud-init.txt\n#cloud-config\npackage_upgrade: true\npackages:\n- stress\nruncmd:\n- sudo stress --cpu 1\nEOF\n</code></pre> </li> <li> <p>To set up an Ubuntu Linux VM, run the following\u00a0<code>az vm create</code>\u00a0command. This command uses the\u00a0<code>cloud-init.txt</code>\u00a0file that you created in the previous step to configure the newly created Ubuntu Linux VM.</p> <p>Azure CLICopy</p> <pre><code>az vm create \\\n    --resource-group \"[sandbox resource group name]\" \\\n    --name vm1 \\\n    --location eastUS \\\n    --image Ubuntu2204 \\\n    --custom-data cloud-init.txt \\\n    --generate-ssh-keys\n</code></pre> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-the-metric-alert-using-the-azure-portal","title":"Create the metric alert using the Azure portal","text":"<p>Note</p> <p>Wait until the VM is successfully created before proceeding with the exercise. The VM creation process is complete when you get the completed JSON output in the Azure Cloud Shell window.</p> <p>You can use either the Azure portal or the CLI to create a metric alert. In this exercise, we cover both, starting with the Azure portal.</p> <ol> <li> <p>Sign in to the\u00a0Azure portal\u00a0using the same account that you used to activate the sandbox.</p> </li> <li> <p>On the Azure portal menu, search for and select\u00a0Monitor. On the\u00a0Monitor Overview\u00a0page, select\u00a0Alerts.</p> </li> <li> <p>Open the\u00a0+ Create\u00a0menu, and select\u00a0Alert rule</p> </li> <li> <p>On the\u00a0Select a resource\u00a0pane, set the scope for your alert rule. You can filter by subscription, resource type, or resource location.</p> </li> <li> <p>In the\u00a0Resource types\u00a0drop-down, start to type \"virtual machines\", and select\u00a0Virtual machines.</p> </li> <li> <p>Check the box next to\u00a0vm1, then select\u00a0Apply\u00a0at the bottom of the pane.</p> <p></p> </li> <li> <p>Select\u00a0Next:Condition\u00a0at the bottom of the page.</p> </li> <li> <p>In the\u00a0Signal name\u00a0drop-down, select\u00a0Percentage CPU.</p> </li> <li> <p>In the\u00a0Alert logic\u00a0section, enter (or confirm) the following values for each setting.</p> </li> </ol> Setting Value Alert logic Threshold Static Aggregation type Maximum Operator Greater than Threshold value 90 When to evaluate Check every 1 minute Lookback period 1 minute <pre><code>![Screenshot that shows the settings for metric condition logic.](https://learn.microsoft.com/en-us/training/modules/incident-response-with-alerting-on-azure/media/4-metric-alert-logic.png)\n</code></pre> <ol> <li>Select the\u00a0Details\u00a0tab at the top of the page. In the\u00a0Alert rule details\u00a0section, enter the following values for each setting.</li> </ol> Setting Value Severity 2 - Warning Alert rule name Cpu90PercentAlert Description Virtual machine is running at or greater than 90% CPU utilization <ol> <li>Expand the\u00a0Advanced options\u00a0section and confirm the following values for each setting.</li> </ol> Setting Value Enable upon creation Yes (checked) Automatically resolve alerts Yes (checked) <pre><code>[![Screenshot that shows the completed settings for the Alert rule details section.](https://learn.microsoft.com/en-us/training/modules/incident-response-with-alerting-on-azure/media/4-metric-alert-details.png)](https://learn.microsoft.com/en-us/training/modules/incident-response-with-alerting-on-azure/media/4-metric-alert-details.png#lightbox)\n</code></pre> <ol> <li>Select\u00a0Review + create\u00a0to validate your input, and then select\u00a0Create.</li> </ol> <p>You successfully created a metric alert rule that triggers an alert when the CPU percentage on the VM exceeds 90 percent. The rule checks every minute and reviews one minute of data. It can take up to 10 minutes for a metric alert rule to become active.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-the-metric-alert-through-the-cli","title":"Create the metric alert through the CLI","text":"<p>You can also set up metric alerts by using the CLI. This process can be quicker than using the portal, especially if you're planning to set up more than one alert.</p> <p>Let's create a new metric alert similar to the one you set up in the Azure portal.</p> <ol> <li> <p>Run the following command in Cloud Shell to obtain the resource ID of the virtual machine you previously created:</p> <p>BashCopy</p> <pre><code>VMID=$(az vm show \\\n        --resource-group \"[sandbox resource group name]\" \\\n        --name vm1 \\\n        --query id \\\n        --output tsv)\n</code></pre> </li> <li> <p>Run the following command to create a new metric alert. The alert is triggered when the VM CPU is greater than 80 percent.</p> <p>Azure CLICopy</p> <pre><code>az monitor metrics alert create \\\n    -n \"Cpu80PercentAlert\" \\\n    --resource-group \"[sandbox resource group name]\" \\\n    --scopes $VMID \\\n    --condition \"max percentage CPU &gt; 80\" \\\n    --description \"Virtual machine is running at or greater than 80% CPU utilization\" \\\n    --evaluation-frequency 1m \\\n    --window-size 1m \\\n    --severity 3\n</code></pre> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#view-your-metric-alerts-in-azure-monitor","title":"View your metric alerts in Azure Monitor","text":"<p>In this exercise, you set up an Ubuntu VM and configured it to stress test the CPU. You also created a metric rule to detect when the maximum CPU percentage exceeds 80 percent and 90 percent.</p> <p>Note</p> <p>It might take 10 minutes before you see the alerts show up in the Azure portal.</p> <ol> <li> <p>Return to the\u00a0Azure portal.</p> </li> <li> <p>On the Azure portal menu, select\u00a0Monitor, and then select\u00a0Alerts\u00a0in the left menu pane.</p> <p>This step presents the Alert summary pane, where you can see the count of the number of alerts. If you don't see your alerts listed, wait a few minutes and select\u00a0Refresh.</p> <p></p> </li> <li> <p>You configured your metric alerts with severities of 2 and 3. Select one of the alerts to view the severity level.</p> </li> <li> <p>Select one of the alerts to show the alert details.</p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-log-search-alerts-to-alert-on-events-in-your-application","title":"Use log search alerts to alert on events in your application","text":"<p>You can use Azure Monitor to capture important information from log files. Applications, operating systems, other hardware, or Azure services can create these log files.</p> <p>As a solution architect, you want to explore ways that monitoring log data can detect issues before they become issues for your customers. You know that Azure Monitor supports the use of log data.</p> <p>In this unit, you understand how using log data can improve resilience in your system.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#when-to-use-log-search-alerts","title":"When to use log search alerts","text":"<p>Log search alerts use log data to assess the rule logic and, if necessary, trigger an alert. This data can come from any Azure resource: server logs, application server logs, or application logs.</p> <p>By its nature, log data is historical, so usage is focused on analytics and trends.</p> <p>You can use these types of logs to assess if any of your servers exceeded their CPU utilization by a given threshold during the last 30 minutes. Or, you could evaluate response codes issued on your web application server in the last hour.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#how-log-search-alerts-work","title":"How log search alerts work","text":"<p>Log search alerts behave in a slightly different way than other alert mechanisms. The first part of a log search alert defines the log search rule. The rule defines how often it should run, the time period under evaluation, and the query to be run.</p> <p>When a log search evaluates as positive, it creates an alert record and triggers any associated actions.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#composition-of-log-search-rules","title":"Composition of log search rules","text":"<p>Every log search alert has an associated search rule with the following composition:</p> <ul> <li>Log query: Query that runs every time the alert rule fires.</li> <li>Time period: Time range for the query.</li> <li>Frequency: How often the query should run.</li> <li>Threshold: Trigger point for an alert to be created.</li> </ul> <p>Log search results are one of two types:\u00a0number of records\u00a0or\u00a0metric measurement.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#number-of-records","title":"Number of records","text":"<p>Consider using the number-of-records type of log search when you're working with an event or event-driven data. Examples are syslog and web-app responses.</p> <p>This type of log search returns a single alert when the number of records in a search result reaches or exceeds the value for the number of records (threshold). For example, when the threshold for the search rule is greater or equal to five, the query results have to return five or more rows of data before the alert is triggered.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#metric-measurement","title":"Metric measurement","text":"<p>Metric measurement logs offer the same basic functionality as metric alert logs.</p> <p>Unlike number-of-records search logs, metric measurement logs require further criteria to be set:</p> <ul> <li>Aggregate function: The calculation to be made against the result data. An example is count or average. The result of the function is called\u00a0AggregatedValue.</li> <li>Group field: Indicates how the result should be grouped. This criterion is used with the aggregated value. For example, you might specify that you want the average grouped by computer.</li> <li>Interval: The time interval by which data is aggregated. For example, if you specify 10 minutes, an alert record is created for each aggregated block of 10 minutes.</li> <li>Threshold: A point defined by an aggregated value and the total number of breaches.</li> </ul> <p>Consider using this type of alert when you need to add a level of tolerance to the results found. One use for this type of alert is to respond if a particular trend or pattern is found. For example, if the number of breaches is five, and any server in your group exceeds 85 percent CPU utilization more than five times within the given time period, an alert fires.</p> <p>As you can see, metric measurements greatly reduce the volume of alerts that are produced. Still, give careful consideration when you're setting the threshold parameters to avoid missing critical alerts.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#stateless-nature-of-log-search-alerts","title":"Stateless nature of log search alerts","text":"<p>One of the primary considerations when you're evaluating the use of log search alerts is that they're stateless (stateful log search alerts are\u00a0currently in preview). A stateless log search alert generates new alerts every time the rule criteria are triggered, regardless of whether the alert was previously recorded.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-activity-log-alerts-to-alert-on-events-within-your-azure-infrastructure","title":"Use activity log alerts to alert on events within your Azure infrastructure","text":"<p>Activity log alerts allow you to be notified when a specific event happens on some Azure resource. For example, you can be notified when someone creates a new virtual machine (VM) in a subscription.</p> <p>An activity log can also include alerts for Azure service health. A company can get notifications when service issues or planned maintenance happens on the Azure platform.</p> <p>As an Azure solution architect, you want to explore the capability to monitor selected Azure resources within your subscription. You want to understand how you can use the resources to improve your team's responsiveness and the stability of your systems.</p> <p>In this unit, you explore the two different kinds of activity log alerts. Now that you're aware of the different kinds of alerts you can use in Azure Monitor, you want to know how you can trigger actions for your alerts. Actions might include sending an email or creating an IT Service Management (ITSM) support ticket.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#when-to-use-activity-log-alerts","title":"When to use activity log alerts","text":"<p>So far, you learned about two different types of alerts supported in Azure Monitor.\u00a0Metric alerts\u00a0are ideally suited to monitoring for threshold breaches or spotting trends;\u00a0Log search alerts\u00a0allow for greater analytical monitoring of historical data.</p> <p>Activity log alerts\u00a0are designed to work with Azure resources. Typically, you create this type of log to receive notifications when specific changes occur on a resource within your Azure subscription.</p> <p>There are two types of activity log alerts:</p> <ul> <li>Specific operations: Applies to resources within your Azure subscription, and often has a scope with specific resources or a resource group. You use this type when you need to receive an alert that reports a change to an aspect of your subscription. For example, you can receive an alert if a VM is deleted or new roles are assigned to a user.</li> <li>Service health events: Include notice of incidents and maintenance of target resources.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#composition-of-an-activity-log-alert","title":"Composition of an activity log alert","text":"<p>It's important to note that activity log alerts monitor events only in the subscription where the alert was created.</p> <p>Activity log alerts are based on events. The best approach for defining them is to use Azure Monitor to filter all the events in your subscription until you find the one that you want. To begin the creation process, you then select\u00a0Add activity log alert.</p> <p>Like the previous alerts, activity log alerts have their own attributes:</p> <ul> <li>Category: Administrative, service health, autoscale, policy, or recommendation</li> <li>Scope: Resource level, resource group level, or subscription level</li> <li>Resource group: Where the alert rule is saved</li> <li>Resource type: Namespace for the target of the alert</li> <li>Operation name: Operation name</li> <li>Level: Verbose, informational, warning, error, or critical</li> <li>Status: Started, failed, or succeeded</li> <li>Event initiated by: Email address or Microsoft Entra identifier (known as the \"caller\") for the user</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-a-resource-specific-log-alert","title":"Create a resource-specific log alert","text":"<p>When you create your activity log alert, you select\u00a0Activity Log\u00a0for the signal type. You then see all the available alerts for the resource you select. The following image shows all the administrative alerts for Azure VMs. In this example, an alert is triggered when a VM is powered off.</p> <p>Changing the monitor service enables you to reduce the list of options. Selecting\u00a0Administrative\u00a0filters all the signals to show only admin-related signals.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-a-service-health-alert","title":"Create a service health alert","text":"<p>Service health alerts aren't like all the other alert types you learned about in this module so far. To create a new alert, search for and select\u00a0Service Health\u00a0in the Azure portal. Next, select\u00a0Health alerts. After you select\u00a0Create service health alert, the steps to create the alert are similar to the steps used to create other alerts.</p> <p></p> <p>The only difference is that you no longer need to select a resource, because the alert is for a whole region in Azure. What you can select is the kind of health event on which you want to be alerted. You can select service issues, planned maintenance, health advisories, or choose all of the events. The remaining steps of performing actions and naming the alerts are the same.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-action-groups-and-alert-processing-rules-to-send-notifications-when-an-alert-is-fired","title":"Use action groups and alert processing rules to send notifications when an alert is fired","text":"<p>Azure Monitor, Azure Service Health, and Azure Advisor use\u00a0action groups\u00a0to notify users about the alert, and to take an action when an alert is fired. An action group is a collection of notification preferences and actions that are executed when the alert is fired. You can run one or more actions for each triggered alert.</p> <p>Azure Monitor can perform any of the following actions:</p> <ul> <li>Send an email</li> <li>Send a Short Message Service (SMS) message</li> <li>Create an Azure app push notification</li> <li>Make a voice call to a number</li> <li>Call an Azure function</li> <li>Trigger a logic app</li> <li>Send a notification to a webhook</li> <li>Create an IT Service Management (ITSM) ticket</li> <li>Use a runbook (to restart a virtual machine (VM) or scale a VM up or down)</li> </ul> <p>Once you create an action group, you can reuse that action group as often as you want. For example, after you create an action to email your company's operations team, you can add that action group to all service-health events.</p> <p>While you're creating the alert rule, you can either create a new action group or add an existing action group to the alert rule. You can also edit an existing alert to add an action group.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#alert-processing-rules","title":"Alert processing rules","text":"<p>Use alert processing rules to override the normal behavior of a fired alert by adding or suppressing an action group. You can use alert processing rules to add action groups or remove (suppress) action groups from your fired alerts. Alert processing rules are different from alert rules. Alert rules trigger alerts when a condition is met in your monitored resources. Alert processing rules modify the alerts as they're being fired.</p> <p>You can use alert processing rules to:</p> <ul> <li>Suppress notifications during planned maintenance windows.</li> <li>Implement management at scale, by specifying commonly used logic in a single rule, instead of having to set it consistently in all your alert rules.</li> <li>Add an action group to all alert types.</li> </ul> <p>You can apply alert processing rules to different resource scopes, from a single resource, or to an entire subscription. You can also use them to apply various filters or have the rule work on a predefined schedule.</p> <p>You can control when the alert processing rule applies. By default the rule is always active. But, you can select a one-time window for this rule to apply, or you can set a recurrence such as a weekly recurrence.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#exercise-use-an-activity-log-alert-and-an-action-group-to-notify-users-about-events-in-your-azure-infrastructure","title":"Exercise -Use an activity log alert and an action group to notify users about events in your Azure infrastructure","text":"<p>The shipping company for which you work wants to avoid any future issues with updates to its applications on the Azure platform. To improve the alerting capabilities within Azure, you can create activity log alerts.</p> <p>Your goal is to set up a Linux virtual machine (VM) and create an activity log monitoring rule to detect when a VM is deleted. Then, delete the VM to trigger this alert.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-the-azure-activity-log-monitor","title":"Create the Azure activity log monitor","text":"<ol> <li> <p>Sign in to the\u00a0Azure portal\u00a0with the same account you used to activate the sandbox.</p> </li> <li> <p>On the Azure portal resource menu or under\u00a0Azure services, select\u00a0Monitor. The\u00a0Overview\u00a0pane for Monitor appears.</p> </li> <li> <p>In the Monitor menu, select\u00a0Alerts. The\u00a0Monitor | Alerts\u00a0pane appears.</p> </li> <li> <p>On the command bar, select\u00a0Create +\u00a0and select\u00a0Alert rule. The\u00a0Create an alert rule\u00a0pane appears with the\u00a0Scope\u00a0section open and the\u00a0Select a resource\u00a0pane open on the right-hand side of your screen.</p> </li> <li> <p>In the\u00a0Resource type\u00a0dropdown list, search for and select\u00a0Virtual machines.</p> </li> <li> <p>You want an alert when any virtual machine in your resource group is deleted. Select the box for the\u00a0[sandbox resource group name]\u00a0resource group, then select\u00a0Apply.</p> <p></p> </li> <li> <p>The\u00a0Create an alert rule\u00a0pane reappears with the Scope target resource showing\u00a0All Virtual machines. Select the\u00a0Condition\u00a0tab. The\u00a0Select a signal\u00a0pane appears.</p> </li> <li> <p>Select the\u00a0See all signals\u00a0link, then search for and select\u00a0Delete Virtual Machine (Virtual Machines). Select\u00a0Apply</p> </li> <li> <p>The\u00a0Create an alert rule\u00a0pane reappears. You want to receive alerts of all types, so leave\u00a0Alert logic\u00a0settings at their default of\u00a0All selected. Leave the\u00a0Create an alert rule\u00a0pane open for the next section.</p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#add-an-email-alert-action","title":"Add an email alert action","text":"<p>For the previous Azure Monitor alert, you didn't add any actions. You just viewed triggered alerts in the Azure portal. Actions let you send an email for notifications, to trigger an Azure function, or to call a webhook. In this exercise, we're adding an email alert when VMs are deleted.</p> <ol> <li> <p>On the\u00a0Create an alert rule\u00a0pane, select the\u00a0Next: Actions\u00a0button, and select\u00a0Use action groups.</p> </li> <li> <p>Select\u00a0Create action group\u00a0in the\u00a0Select action group\u00a0pane. The\u00a0Create an action group\u00a0pane appears.</p> </li> <li> <p>On the\u00a0Basics\u00a0tab, enter the following values for each setting.</p> </li> </ol> Setting Value Project details Subscription Concierge Subscription Resource group From the dropdown list, select your sandbox resource group Region Global\u00a0(default) Instance details Action group name Alert the operations team Display name AlertOps <ol> <li>Select\u00a0Next: Notifications, and enter the following values for each setting.</li> </ol> Setting Value Notification type Select\u00a0Email/SMS message/Push/Voice Name VM was deleted <ol> <li> <p>The\u00a0Email/SMS message/Push/Voice\u00a0pane appears automatically. If it didn't, select the\u00a0Edit\u00a0pencil icon.</p> </li> <li> <p>Select\u00a0Email, and in the\u00a0Email\u00a0box, enter your email address, and then select\u00a0OK.</p> </li> <li> <p>Select\u00a0Review + create\u00a0to validate your input.</p> </li> <li> <p>Select\u00a0Create.</p> </li> <li> <p>The\u00a0Create an alert rule\u00a0pane reappears. Select\u00a0Next: Details\u00a0and enter the following values for each setting.</p> </li> </ol> Setting Value Alert rule name VM was deleted Description A VM in your resource group was deleted <ol> <li> <p>Expand the\u00a0Advanced options\u00a0section and confirm that\u00a0Enable alert rule upon creation\u00a0is selected.</p> <p></p> </li> <li> <p>Select\u00a0Review + create\u00a0to validate your input, then select\u00a0Create.</p> </li> </ol> <p>Recipients added to the configured action group (operations team) receive a notification:</p> <ul> <li>When they're added to the action group</li> <li>When the alert is activated</li> <li>When the alert is triggered</li> </ul> <p>It can take up to five minutes for an activity log alert rule to become active. In this exercise, if you delete the virtual machine before the rule deploys, the alert rule might not be triggered. Because of this delay, you might not see the same results in the following steps after you delete the VM.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#delete-your-virtual-machine","title":"Delete your virtual machine","text":"<p>To trigger an alert, you need to delete the Linux VM that you created in the previous exercise.</p> <ol> <li> <p>On the Azure portal menu or from the\u00a0Home\u00a0page, select\u00a0Virtual machines.</p> </li> <li> <p>Check the box for the\u00a0vm1\u00a0virtual machine.</p> </li> <li> <p>Select\u00a0Delete\u00a0from the menu bar.</p> </li> <li> <p>Enter\u00a0delete\u00a0to confirm deletion and select\u00a0Delete.</p> </li> <li> <p>In the title bar, select the\u00a0Notifications\u00a0icon and wait until\u00a0vm1\u00a0is successfully deleted.</p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#view-your-activity-log-alerts-in-azure-monitor","title":"View your activity log alerts in Azure Monitor","text":"<p>In the exercise, you set up an Ubuntu VM and created an activity log rule to detect when the VM was deleted. You then deleted a VM from your resource group. Let's check whether an alert was triggered.</p> <ol> <li> <p>You should receive a notification email that reads,\u00a0Important notice: Azure Monitor alert VM was deleted was activated...\u00a0If not, open your email program and look for an email from azure-noreply@microsoft.com.</p> <p></p> </li> <li> <p>On the Azure portal resource menu, select\u00a0Monitor, and then select\u00a0Alerts\u00a0in the menu on the left.</p> </li> <li> <p>You should have three verbose alerts that were generated by deleting\u00a0vm1.</p> <p></p> </li> <li> <p>Select the name of one of the alerts (For example,\u00a0VM was deleted). An\u00a0Alert details\u00a0pane appears that shows more details about the event.</p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#add-an-alert-processing-rule-to-the-alert","title":"Add an alert processing rule to the alert","text":"<p>We're going to schedule a one-time, overnight, planned maintenance. It starts in the evening and continues until the next morning.</p> <ol> <li> <p>In the Azure portal resource menu, select\u00a0Monitor, select\u00a0Alerts\u00a0in the menu on the left, and select\u00a0Alert processing rules\u00a0in the menu bar.</p> </li> <li> <p>Select\u00a0+ Create.</p> </li> <li> <p>Check the box for your sandbox resource group as the scope of the alert processing rule, then select\u00a0Apply.</p> </li> <li> <p>Select\u00a0Next: Rule settings, then select\u00a0Suppress notifications.</p> </li> <li> <p>Select\u00a0Next: Scheduling.</p> </li> <li> <p>By default, the rule works all the time, unless you disable it. We're going to define the rule to suppress notifications for a one-time overnight planned maintenance. Enter these settings for the scheduling of the alert processing rule:</p> </li> </ol> Setting Value Apply the rule At a specific time Start Enter today's date at 10pm. End Enter tomorrow's date at 7am. Time zone Select the local timezone. <p>https://learn.microsoft.com/en-us/training/modules/incident-response-with-alerting-on-azure/media/8-alert-processing-rule-schedule.png#lightbox</p> <ol> <li>Select\u00a0Next: Details\u00a0and enter these settings:</li> </ol> Setting Value Resource group Select your sandbox resource group. Rule name Planned Maintenance Description Suppress notifications during planned maintenance. <ol> <li>Select\u00a0Review + create\u00a0to validate your input, then select\u00a0Create.</li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#analyze-your-azure-infrastructure-by-using-azure-monitor-logs","title":"Analyze your Azure infrastructure by using Azure Monitor logs","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction_5","title":"Introduction","text":"<p>Logging and monitoring the health of your services is a vital component of production applications. You need to be able to determine the causes of failures. You also need to identify any problems before they occur.</p> <p>Azure Monitor is an important tool to help you in this process. It allows you to gather monitoring and diagnostic information about the health of your services. You can use this information to visualize and analyze the causes of problems that might occur in your app.</p> <p>Suppose that you work for a large organization's operations team. The organization is running large-scale production apps in the cloud. The team wants to consolidate its log data in a single service to improve visibility across services and simplify its logging strategy.</p> <p>The team began implementing Azure Monitor logs. It wants to fully understand how the logs work. It also wants to know the service's capabilities to query and evaluate the log data that's fed into it.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#learning-objectives_3","title":"Learning objectives","text":"<p>In this module, you'll:</p> <ul> <li>Identify the features and capabilities of Azure Monitor logs.</li> <li>Create basic Azure Monitor log queries to extract information from log data.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#features-of-azure-monitor-logs","title":"Features of Azure Monitor logs","text":"<p>Azure Monitor is a service for collecting and analyzing telemetry. It helps you get maximum performance and availability for your cloud applications and for your on-premises resources and applications. It shows how your applications are performing and identifies any issues with them.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#data-collection-in-azure-monitor","title":"Data collection in Azure Monitor","text":"<p>Azure Monitor collects two fundamental types of data: metrics and logs. Metrics tell you how a resource is performing and the other resources that it's consuming. Logs contain records that show when resources are created or modified.</p> <p>The following diagram gives a high-level view of Azure Monitor. On the left are the data-monitoring sources: Azure, operating systems, and custom sources. At the center of the diagram are the data stores for metrics and logs. On the right are the functions that Azure Monitor performs with this collected data, such as analysis, alerting, and streaming to external systems.</p> <p></p> <p>Azure Monitor collects data automatically from a range of components. For example:</p> <ul> <li>Application data: Data that relates to your custom application code.</li> <li>Operating-system data: Data from the Windows or Linux virtual machines that host your application.</li> <li>Azure resource data: Data that relates to the operations of an Azure resource, such as a web app or a load balancer.</li> <li>Azure subscription data: Data that relates to your subscription, including data about Azure health and availability.</li> <li>Azure tenant data: Data about your Azure organization-level services, such as Microsoft Entra ID.</li> </ul> <p>Because Azure Monitor is an automatic system, it begins to collect data from these sources as soon as you create Azure resources like virtual machines and web apps. You can extend the data that Azure Monitor collects by:</p> <ul> <li>Enabling diagnostics: For some resources, such as Azure SQL Databases, you'll receive full information about a resource only after you've enabled diagnostic logging for it. You can use the Azure portal, the Azure CLI, or PowerShell to enable diagnostics.</li> <li>Adding an agent: For virtual machines, you can install the Log Analytics agent and configure it to send data to a Log Analytics workspace. This agent increases the amount of information that's sent to Azure Monitor.</li> </ul> <p>Your developers might also want to send data to Azure Monitor from custom code such as a web app, an Azure function, or a mobile app. They send data by calling the Data Collector API. You can communicate with this REST interface through HTTP. This interface is compatible with various development frameworks such as .NET Framework, Node.js, and Python. Developers can choose their favorite language and framework to log data in Azure Monitor.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#logs","title":"Logs","text":"<p>Logs contain time-stamped information about resource changes. The type of information recorded varies by log source. The log data is organized into records, with different sets of properties for each type of record. The logs can include numeric values like Azure Monitor metrics, but most include text data rather than numeric values.</p> <p>The most common type of log entry records an event. Events can occur sporadically rather than at fixed intervals or according to a schedule. Applications and services create events and provide the event context. You can store metric data in logs to combine them with other monitoring data for analysis.</p> <p>You can log data from Azure Monitor in a Log Analytics workspace. Azure provides an analysis engine and a rich query language. The logs show the context of any problems, and they're useful for identifying root causes.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#metrics","title":"Metrics","text":"<p>Metrics are numerical values that describe some aspect of a system at a point in time. Azure Monitor can capture metrics in near-real time. The metrics are collected at regular intervals, and they're useful for alerting because of their frequent sampling. You can use various algorithms to compare a metric to other metrics and observe trends over time.</p> <p>Metrics are stored in a time-series database. This data store is most effective for analyzing time-stamped data. Metrics are suited for alerting and fast detection of issues. They can tell you about system performance. If needed, you can combine them with logs to identify the root cause of issues.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#analyzing-logs-by-using-kusto","title":"Analyzing logs by using Kusto","text":"<p>To retrieve, consolidate, and analyze data, you can specify a query to run in Azure Monitor logs. You can write a log query with the Kusto query language, which Azure Data Explorer also uses.</p> <p>You can test log queries in the Azure portal so you can work with them interactively. You'll typically start with basic queries, then progress to more advanced functions as your requirements become more complex.</p> <p>In the Azure portal, you can create custom dashboards, which are targeted displays of resources and data. You can build each dashboard from a set of tiles. Each tile might show a set of resources, a chart, a data table, or some custom text. Azure Monitor provides tiles that you can add to dashboards; for example, you might use a tile to display a Kusto query's results in a dashboard.</p> <p>In the example scenario, the operations team can consolidate its monitoring data by visualizing it in charts and tables. These tools are effective for summarizing data and presenting it to different audiences.</p> <p>By using Azure dashboards, you can combine various kinds of data\u2014including both logs and metrics\u2014into a single pane in the Azure portal. For example, you might want to create a dashboard that combines tiles that show a graph of metrics, a table of activity logs, charts from Azure Monitor, and a log query's output.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-basic-azure-monitor-log-queries-to-extract-information-from-log-data","title":"Create basic Azure Monitor log queries to extract information from log data","text":"<p>You can use Azure Monitor log queries to extract information from log data. Querying is an important part of examining the log data that Azure Monitor captures.</p> <p>In the example scenario, the operations team uses Azure Monitor log queries to examine the health of its system.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#write-azure-monitor-log-queries-by-using-log-analytics","title":"Write Azure Monitor log queries by using Log Analytics","text":"<p>You can find the Log Analytics tool in the Azure portal and use it to run sample queries or to create your own queries:</p> <ol> <li> <p>In the Azure portal, in the left menu pane, select\u00a0Monitor.</p> <p>The Azure Monitor page appears along with more options, including\u00a0Activity Log,\u00a0Alerts,\u00a0Metrics, and\u00a0Logs.</p> </li> <li> <p>Select\u00a0Logs.</p> <p>Here, you can enter your query and see the output.</p> <p></p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#write-queries-by-using-the-kusto-language","title":"Write queries by using the Kusto language","text":"<p>You can use the Kusto Query Language to query log information for your services running in Azure. A Kusto query is a read-only request to process data and return results. You'll state the query in plain text by using a data-flow model that's designed to make the syntax easy to read, write, and automate. The query uses schema entities that are organized in a hierarchy similar to that of Azure SQL Database: databases, tables, and columns.</p> <p>A Kusto query consists of a sequence of query statements delimited by a semicolon (<code>;</code>). At least one statement is a tabular expression statement. A tabular expression statement formats the data arranged as a table of columns and rows.</p> <p>A tabular expression statement's syntax has a tabular data flow from one tabular query operator to another, starting with a data source. A data source might be a table in a database or an operator that produces data. The data then flows through a set of data-transformation operators that are bound together with the pipe (<code>|</code>) delimiter.</p> <p>For example, the following Kusto query has a single tabular expression statement. The statement starts with a reference to a table called\u00a0<code>Events</code>. The database that hosts this table is implicit here, and is part of the connection information. The data for that table, stored in rows, is filtered by the value of the\u00a0<code>StartTime</code>\u00a0column. The data is filtered further by the value of the\u00a0<code>State</code>\u00a0column. The query then returns the count of the resulting rows.</p> <p>KustoCopy</p> <pre><code>Events\n| where StartTime &gt;= datetime(2018-11-01) and StartTime &lt; datetime(2018-12-01)\n| where State == \"FLORIDA\"  \n| count\n</code></pre> <p>Note</p> <p>The Kusto query language that Azure Monitor uses is case-sensitive. Language keywords are typically written in lowercase. When you're using names of tables or columns in a query, make sure to use the correct case.</p> <p>Events captured from the event logs of monitored computers are just one type of data source. Azure Monitor provides many other types of data sources. For example, the\u00a0<code>Heartbeat</code>\u00a0data source reports the health of all computers that report to your Log Analytics workspace. You can also capture data from performance counters and update management records.</p> <p>The following example retrieves the most recent heartbeat record for each computer. The computer is identified by its IP address. In this example, the\u00a0<code>summarize</code>\u00a0aggregation with the\u00a0<code>arg_max</code>\u00a0function returns the record with the most recent value for each IP address.</p> <p>KustoCopy</p> <pre><code>Heartbeat\n| summarize arg_max(TimeGenerated, *) by ComputerIP\n</code></pre>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#exercise-create-basic-azure-monitor-log-queries-to-extract-information-from-log-data","title":"Exercise - Create basic Azure Monitor log queries to extract information from log data","text":"<p>The operations team doesn't currently have enough information about its system behavior to diagnose and resolve problems effectively. To address this issue, the team has configured an Azure Monitor workspace with the company's Azure services. It runs Kusto queries to get the system's status and attempts to identify the causes of any problems that might occur.</p> <p>In particular, the team is interested in monitoring security events to check for possible attempts to break into the system. An attacker might try to manipulate the applications running on the system, so the team also wants to gather application data for further analysis. An attacker might also try to halt the computers that compose the system, so the team wants to examine how and when machines are stopped and restarted.</p> <p>In this exercise, you'll practice performing Azure log queries against a demo project that contains sample data in tables, logs, and queries.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-basic-azure-monitor-log-queries-to-extract-information-from-log-data_1","title":"Create basic Azure Monitor log queries to extract information from log data","text":"<p>Let's use the\u00a0Azure Demo Logs pane\u00a0to practice writing queries. The demo project workspace is prepopulated with sample data. Azure offers an optimized SQL-like query with visualization options of its data in a language called KQL (Kusto Query Language.)</p> <ol> <li> <p>Open the\u00a0Logs demo environment. In the top-left corner, under\u00a0New Query 1, you'll find\u00a0Demo, which identifies the query's workspace (or scope). The left side of this pane contains several tabs:\u00a0Tables,\u00a0Queries, and\u00a0Functions. The right side has a scratchpad for creating or editing queries.</p> </li> <li> <p>On the\u00a0New Query 1\u00a0tab, enter a basic query on the first line of the scratchpad. This query retrieves the details of the 10 most recent security events.</p> <p>KustoCopy</p> <pre><code>SecurityEvent\n    | take 10\n</code></pre> </li> <li> <p>In the command bar, select\u00a0Run\u00a0to execute the query and view the results. You can expand each row in the results pane for more information.</p> </li> <li> <p>Sort the data by time by adding a filter to your query:</p> <p>KustoCopy</p> <pre><code>SecurityEvent\n    | top 10 by TimeGenerated\n</code></pre> </li> <li> <p>Add a filter clause and a time range. Run this query to fetch records that are more than 30 minutes old and that have a level of 10 or more:</p> <p>KustoCopy</p> <pre><code>SecurityEvent\n    | where TimeGenerated &lt; ago(30m)\n    | where toint(Level) &gt;= 10\n</code></pre> </li> <li> <p>Run the following query to search the\u00a0<code>AppEvents</code>\u00a0table for records of the\u00a0<code>Clicked Schedule Button</code>\u00a0event being invoked in the last 24 hours:</p> <p>KustoCopy</p> <pre><code>AppEvents \n    | where TimeGenerated &gt; ago(24h)\n    | where Name == \"Clicked Schedule Button\"\n</code></pre> </li> <li> <p>Run the following query to display the number of different computers that generated heartbeat events each week for the last three weeks. The results appear as a bar chart:</p> <p>KustoCopy</p> <pre><code>Heartbeat\n    | where TimeGenerated &gt;= startofweek(ago(21d))\n    | summarize dcount(Computer) by endofweek(TimeGenerated) | render barchart kind=default\n</code></pre> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-predefined-azure-log-queries-to-extract-information-from-log-data","title":"Use predefined Azure log queries to extract information from log data","text":"<p>In addition to writing queries from scratch, the operations team can also take advantage of predefined queries in Azure Logs that answer common questions related to their resources' health, availability, usage, and performance.</p> <ol> <li> <p>Use the\u00a0Time Range\u00a0parameter in the command bar to set a custom range. Select the month, year, and day to a range from January to today. You can set and apply a custom time to any query.</p> </li> <li> <p>On the left toolbar, select\u00a0Queries. In the drop-down list in the left menu, you can view a list of the sample queries grouped by\u00a0Category,\u00a0Query type,\u00a0Resource type,\u00a0Solution, or\u00a0Topic.</p> <p></p> </li> <li> <p>Select\u00a0Category\u00a0in the drop-down list, then select\u00a0IT &amp; Management Tools.</p> </li> <li> <p>In the search box, enter\u00a0Distinct missing updates cross computers. Double-click the query in the left pane, then select\u00a0Run. The\u00a0Logs\u00a0pane reappears, with the query returning a list of Windows updates missing from virtual machines that are sending logs to the workspace.</p> <p>Note</p> <p>You can also run this same query from the\u00a0Logs\u00a0pane. In the left pane, select the\u00a0Queries\u00a0tab, then select\u00a0Category\u00a0in the\u00a0Group by\u00a0dropdown list. Now scroll down the list, expand\u00a0IT &amp; Management Tools, and double-click\u00a0Distinct missing updates cross computers. Select\u00a0Run\u00a0to run the query. When you select a predefined query in the left pane, the query code is appended to whatever query exists in the scratchpad. Remember to clear the scratchpad before opening or adding a new query to run.</p> </li> <li> <p>In the left pane, clear the search box. Select\u00a0Queries, then select\u00a0Category\u00a0in the\u00a0Group by\u00a0dropdown list. Expand\u00a0Azure Monitor\u00a0and double-click\u00a0Computers availability today. Select\u00a0Run. This query creates a time series chart with the number of unique IP addresses sending logs into the workspace each hour for the last day.</p> </li> <li> <p>Select\u00a0Topic\u00a0in the\u00a0Group by\u00a0dropdown list, scroll down to expand\u00a0Function App, and then double-click\u00a0Show application logs from Function Apps. Select\u00a0Run. This query returns a list of application logs, sorted by time with the latest logs shown first.</p> </li> </ol> <p>You'll notice that from the Kusto queries you used here, it's easy to target a query to a specific time window, event level, or event log type. The security team can easily examine heartbeats to identify when servers are unavailable, which might indicate a denial-of-service attack. If the team spots the time when a server was unavailable, it can query for events in the security log around that time to diagnose whether an attack caused the interruption. Additionally, predefined queries can also evaluate VM availability, identify missing Windows updates, and review firewall logs to view denied network flows intended for the VMs of interest.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#monitor-your-azure-virtual-machines-with-azure-monitor","title":"Monitor your Azure virtual machines with Azure Monitor","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction_6","title":"Introduction","text":"<p>Suppose you're the IT administrator for a musical group's website hosted on Azure virtual machines (VMs). The website runs mission-critical services for the group, including ticket booking, venue information, and tour updates. The website must respond quickly and remain accessible during frequent updates and spikes in traffic.</p> <p>You need to maintain sufficient VM size and memory to effectively host the website without incurring unnecessary costs. You also need to proactively prevent and quickly respond to any access, security, and performance issues. To help achieve these objectives, you want to quickly and easily monitor your VMs' traffic, health, performance, and events.</p> <p>Azure Monitor provides built-in and customizable monitoring abilities. You can use these to track the health, performance, and behavior of the VM host and the operating system, workloads, and applications running on your VM. This learning module shows you how to view VM host monitoring data, set up recommended alert rules, and use VM insights and custom data collection rules (DCRs) to collect and analyze monitoring data from inside your VMs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#prerequisites_3","title":"Prerequisites","text":"<p>To complete this module, you need the following prerequisites:</p> <ul> <li>Familiarity with virtualization, Azure portal navigation, and Azure VMs.</li> <li>Access to an Azure subscription with at least\u00a0Contributor\u00a0role. If you don't have an Azure subscription, create a\u00a0free account\u00a0and add a subscription before you begin. If you're a student, you can take advantage of the\u00a0Azure for students\u00a0offer.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#learning-objectives_4","title":"Learning objectives","text":"<ul> <li>Understand which monitoring data you need to collect from your VM.</li> <li>Enable and view recommended alerts and diagnostics.</li> <li>Use Azure Monitor to collect and analyze VM host data.</li> <li>Use Azure Monitor Agent to collect VM client performance metrics and event logs.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#introduction_7","title":"Introduction","text":"<p>Suppose you're the IT administrator for a musical group's website hosted on Azure virtual machines (VMs). The website runs mission-critical services for the group, including ticket booking, venue information, and tour updates. The website must respond quickly and remain accessible during frequent updates and spikes in traffic.</p> <p>You need to maintain sufficient VM size and memory to effectively host the website without incurring unnecessary costs. You also need to proactively prevent and quickly respond to any access, security, and performance issues. To help achieve these objectives, you want to quickly and easily monitor your VMs' traffic, health, performance, and events.</p> <p>Azure Monitor provides built-in and customizable monitoring abilities. You can use these to track the health, performance, and behavior of the VM host and the operating system, workloads, and applications running on your VM. This learning module shows you how to view VM host monitoring data, set up recommended alert rules, and use VM insights and custom data collection rules (DCRs) to collect and analyze monitoring data from inside your VMs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#prerequisites_4","title":"Prerequisites","text":"<p>To complete this module, you need the following prerequisites:</p> <ul> <li>Familiarity with virtualization, Azure portal navigation, and Azure VMs.</li> <li>Access to an Azure subscription with at least\u00a0Contributor\u00a0role. If you don't have an Azure subscription, create a\u00a0free account\u00a0and add a subscription before you begin. If you're a student, you can take advantage of the\u00a0Azure for students\u00a0offer.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#learning-objectives_5","title":"Learning objectives","text":"<ul> <li>Understand which monitoring data you need to collect from your VM.</li> <li>Enable and view recommended alerts and diagnostics.</li> <li>Use Azure Monitor to collect and analyze VM host data.</li> <li>Use Azure Monitor Agent to collect VM client performance metrics and event logs.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#monitoring-for-azure-vms","title":"Monitoring for Azure VMs","text":"<p>In this unit, you explore Azure monitoring capabilities for VMs, and the types of monitoring data you can collect and analyze with Azure Monitor. Azure Monitor is a comprehensive monitoring solution for collecting, analyzing, and responding to monitoring data from Azure and non-Azure resources, including VMs. Azure Monitor has two main monitoring features: Azure Monitor Metrics and Azure Monitor Logs.</p> <p>Metrics are numerical values collected at predetermined intervals to describe some aspect of a system. Metrics can measure VM performance, resource utilization, error counts, user responses, or any other aspect of the system that you can quantify. Azure Monitor Metrics automatically monitors a predefined set of metrics for every Azure VM, and retains the data for 93 days with some exceptions.</p> <p>Logs are recorded system events that contain a timestamp and different types of structured or free-form data. Azure automatically records activity logs for all Azure resources. This data is available at the resource level. Azure Monitor doesn't collect logs by default, but you can configure Azure Monitor Logs to collect from any Azure resource. Azure Monitor Logs stores log data in a Log Analytics workspace for querying and analysis.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#vm-monitoring-layers","title":"VM monitoring layers","text":"<p>Azure VMs have several layers that require monitoring. Each of the following layers has a distinct set of telemetry and monitoring requirements.</p> <ul> <li>Host VM</li> <li>Guest operating system (OS)</li> <li>Client workloads</li> <li>Applications that run on the VM</li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#host-vm-monitoring","title":"Host VM monitoring","text":"<p>The VM host represents the compute, storage, and network resources that Azure allocates to the VM.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#vm-host-metrics","title":"VM host metrics","text":"<p>VM host metrics measure technical aspects of the VM such as processor utilization and whether the machine is running. You can use VM host metrics to:</p> <ul> <li>Trigger an alert when your VM is reaching its disk or CPU limits.</li> <li>Identify trends or patterns.</li> <li>Control your operational costs by sizing VMs according to usage and demand.</li> </ul> <p>Azure automatically collects basic metrics for VM hosts. On the VM's\u00a0Overview\u00a0page in the Azure portal, you can see built-in graphs for the following important VM host metrics.</p> <ul> <li>VM availability</li> <li>CPU usage percentage (average)</li> <li>OS disk usage (total)</li> <li>Network operations (total)</li> <li>Disk operations per second (average)</li> </ul> <p>You can use Azure Monitor Metrics Explorer to plot more metrics graphs, investigate changes, and visually correlate metrics trends for your VMs. With Metrics Explorer you can:</p> <ul> <li>Plot multiple metrics on a graph to see how much traffic hits your VM and how the VM performs.</li> <li>Track the same metric over multiple VMs in a resource group or other scope, and use splitting to show each VM on the graph.</li> <li>Select flexible time ranges and granularity.</li> <li>Specify many other settings such as chart type and value ranges.</li> <li>Send graphs to workbooks or pin them to dashboards for quickly viewing health and performance.</li> <li>Group metrics by time intervals, geographic regions, server clusters, or application components.</li> </ul> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#recommended-alert-rules","title":"Recommended alert rules","text":"<p>Alerts proactively notify you of specified occurrences and patterns in your VM host metrics.\u00a0Recommended alert rules\u00a0are a predefined set of alert rules based on commonly monitored host metrics. These rules define recommended CPU, memory, disk, and network usage levels to alert on. The rules also include VM availability, which alerts you when the VM stops running.</p> <p>You can quickly enable and configure recommended alert rules when you create an Azure VM, or afterwards from the VM's portal page. You can also view, configure, and create custom alerts by using Azure Monitor Alerts.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#activity-logs","title":"Activity logs","text":"<p>Azure Monitor automatically records and displays activity logs for Azure VMs. Activity logs include information like VM startup or modifications. You can create diagnostic settings to send activity logs to the following destinations:</p> <ul> <li>Azure Monitor Logs:\u00a0For more complex querying and alerting, and for longer retention up to two years.</li> <li>Azure Storage:\u00a0For cheaper, long-term archiving.</li> <li>Azure Event Hubs:\u00a0To forward outside of Azure.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#boot-diagnostics","title":"Boot diagnostics","text":"<p>Boot diagnostics are host logs you can use to help troubleshoot boot issues with your VMs. You can enable boot diagnostics by default when you create a VM, or afterwards for existing VMs.</p> <p>Once you enable boot diagnostics, you can see screenshots from the VM's hypervisor for both Windows and Linux machines, and view the serial console log output of the VM boot sequence for Linux machines. Boot diagnostics stores data in a managed storage account.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#guest-os-client-workload-and-application-monitoring","title":"Guest OS, client workload, and application monitoring","text":"<p>VM client monitoring can include monitoring the operating system (OS), workloads, and applications that run on the VM. To collect metrics and logs from guest OS and client workloads and applications, you need to install Azure Monitor Agent and set up a DCR.</p> <p>DCRs define what data to collect and where to send that data. You can use a DCR to send Azure Monitor metrics data, or\u00a0performance counters, to Azure Monitor Logs or Azure Monitor Metrics. You can also send event log data to Azure Monitor Logs. In other words, Azure Monitor Metrics can store only metrics data, but Azure Monitor Logs can store both metrics and event logs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#vm-insights","title":"VM insights","text":"<p>VM insights is an Azure Monitor feature that helps get you started monitoring your VM clients. VM insights is especially useful for exploring overall VM usage and performance when you don't yet know the metric of primary interest. VM insights provides:</p> <ul> <li>Simplified Azure Monitor Agent onboarding to enable monitoring a VM's guest OS and workloads.</li> <li>A preconfigured DCR that monitors and collects the most common performance counters for Windows and Linux.</li> <li>Predefined trending performance metrics charts and workbooks from the VM's guest OS.</li> <li>A set of predefined workbooks that show collected VM client metrics over time.</li> <li>Optionally, a collection of processes running on the VM, dependencies with other services, and a dependency map that displays interconnected components with other VMs and external sources.</li> </ul> <p>Predefined VM insights workbooks show performance, connections, active ports, traffic, and other collected data from one or several VMs. You can view VM insights data directly from a single VM, or see a combined view of multiple VMs to view and assess trends and patterns across VMs. You can edit the prebuilt workbook configurations, or create your own custom workbooks.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#client-event-log-data","title":"Client event log data","text":"<p>VM insights creates a DCR that collects a specific set of performance counters. To collect other data, such as event logs, you can create a separate DCR that specifies the data you want to collect from the VM and where to send it. Azure Monitor stores collected log data in a Log Analytics workspace. From there, you can access and analyze the data by using log queries written in Kusto Query Language (KQL).</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#monitor-vm-host-data","title":"Monitor VM host data","text":"<p>You want to monitor the VMs that host your website, so you decide to quickly create a VM in the Azure portal and evaluate its built-in monitoring capabilities. In this unit, you use the Azure portal to create a Linux VM with recommended alerts and boot diagnostics enabled. As soon as the VM starts up, Azure automatically begins collecting basic metrics and activity logs. You can then view built-in metrics graphs, activity logs, and boot diagnostics.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-a-vm-and-enable-recommended-alerts","title":"Create a VM and enable recommended alerts","text":"<ol> <li> <p>Sign in to the\u00a0Azure portal, and in the Search field, enter\u00a0virtual machines.</p> </li> <li> <p>On the\u00a0Virtual machines\u00a0page, select\u00a0Create, and then select\u00a0Azure virtual machine.</p> </li> <li> <p>On the\u00a0Basics\u00a0tab of the\u00a0Create a virtual machine\u00a0page:</p> <ul> <li>In the\u00a0Subscription\u00a0field, select the correct subscription if not already selected.</li> <li>Under\u00a0Resource group:<ol> <li>Select\u00a0Create new.</li> <li>Under\u00a0Name, enter\u00a0learn-monitor-vm-rg.</li> <li>Select\u00a0OK.</li> </ol> </li> <li>For\u00a0Virtual machine name, enter\u00a0monitored-linux-vm.</li> <li>For\u00a0Image, select\u00a0Ubuntu Server 20.04 LTS - x64 Gen2.</li> <li>Leave the other settings at their current values, and select the\u00a0Monitoring\u00a0tab.</li> </ul> <p></p> </li> <li> <p>On the\u00a0Monitoring\u00a0tab, select the checkbox next to\u00a0Enable recommended alert rules.</p> </li> <li> <p>On the\u00a0Set up recommended alert rules\u00a0screen:</p> <ol> <li>Select all the listed alert rules if not already selected, and adjust the values if desired.</li> <li>Under\u00a0Notify me by, select the checkbox next to\u00a0Email, and enter an email address to receive alert notifications.</li> <li>Select\u00a0Save.</li> <li>Under\u00a0Diagnostics, for\u00a0Boot diagnostics, ensure that\u00a0Enable with managed storage account (recommended)\u00a0is selected.</li> </ol> <p>Note</p> <p>Don't select\u00a0Enable OS guest diagnostics. The Linux Diagnostics Agent (LAD) is deprecated, and you can enable OS guest and client monitoring later.</p> </li> <li> <p>Select\u00a0Review + create\u00a0at the bottom of the page, and when validation passes, select\u00a0Create.</p> <p></p> </li> <li> <p>On the\u00a0Generate new key pair\u00a0popup dialog box, select\u00a0Download private key and create resource.</p> </li> </ol> <p>It can take a few minutes to create the VM. When you get the notification that the VM is created, select\u00a0Go to resource\u00a0to see basic metrics data.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#view-built-in-metrics-graphs","title":"View built-in metrics graphs","text":"<p>Once your VM is created, Azure starts collecting basic metrics data automatically. Built-in metrics graphs, along with the recommended alerts you enabled, can help you monitor whether and when your VM encounters health or performance issues. You can then use more advanced monitoring and analytics capabilities to investigate issue causes and remediation.</p> <ol> <li> <p>To view basic metrics graphs, on the VMs\u00a0Overview\u00a0page, select the\u00a0Monitoring\u00a0tab.</p> <p></p> </li> <li> <p>Under\u00a0Performance and utilization\u00a0&gt;\u00a0Platform metrics, review the following metrics graphs related to the VMs performance and utilization. Select\u00a0Show more metrics\u00a0if all the graphs don't appear immediately.</p> <ul> <li>VM Availability</li> <li>CPU (average)</li> <li>Disk bytes (total)</li> <li>Network (total)</li> <li>Disk operations/sec (average)</li> </ul> <p></p> </li> <li> <p>Under\u00a0Guest OS metrics, notice that guest OS metrics aren't being collected yet. In the next units, you configure VM insights and data collection rules to collect guest OS metrics.</p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#view-the-activity-log","title":"View the activity log","text":"<p>You can view the VMs activity log by selecting\u00a0Activity log\u00a0from the VMs left navigation menu. You can also retrieve entries by using PowerShell or the Azure CLI.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#view-boot-diagnostics","title":"View boot diagnostics","text":"<p>You enabled boot diagnostics when you created the VM. You can view boot diagnostics to view boot data and troubleshoot startup issues.</p> <ol> <li> <p>In the left navigation menu for the VM, select\u00a0Boot diagnostics\u00a0under\u00a0Help.</p> </li> <li> <p>On the\u00a0Boot diagnostics\u00a0page, select\u00a0Screenshot\u00a0to see a startup screenshot from the VMs hypervisor. Select\u00a0Serial log\u00a0to view log messages created when the VM started.</p> <p></p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#use-metrics-explorer-to-view-detailed-host-metrics","title":"Use Metrics Explorer to view detailed host metrics","text":"<p>You want to investigate how traffic flowing into your VM affects its CPU capability. If the built-in metrics charts for a VM don't already show the data you need, you can use Metrics Explorer to create customized metrics charts. In this unit, you plot a graph that displays your VM's maximum percentage CPU and average inbound flow data together.</p> <p>Azure Monitor Metrics Explorer offers a UI for exploring and analyzing VM metrics. You can use Metrics Explorer to view and create custom charts for many VM host metrics in addition to the metrics shown on the built-in graphs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#understand-metrics-explorer","title":"Understand Metrics Explorer","text":"<p>To open Metrics Explorer, you can:</p> <ul> <li>Select\u00a0Metrics\u00a0from the VM's left navigation menu under\u00a0Monitoring.</li> <li>Select the\u00a0See all Metrics\u00a0link next to\u00a0Platform metrics\u00a0on the\u00a0Monitoring\u00a0tab of the VM's\u00a0Overview\u00a0page.</li> <li>Select\u00a0Metrics\u00a0from the left navigation menu on the Azure Monitor\u00a0Overview\u00a0page.</li> </ul> <p></p> <p>In Metrics Explorer, you can select the following values from the dropdown fields:</p> <ul> <li>Scope:\u00a0If you open Metrics Explorer from a VM, this field is prepopulated with the VM name. You can add more items with the same resource type (VMs) and location.</li> <li>Metric Namespace: Most resource types have only one namespace, but for some types, you must pick a namespace. For example, storage accounts have separate namespaces for files, tables, blobs, and queues.</li> <li>Metric: Each metrics namespace has many metrics available to choose from.</li> <li>Aggregation: For each metric, Metrics Explorer applies a default aggregation. You can use a different aggregation to get different information about the metric.</li> </ul> <p>You can apply the following aggregation functions to metrics:</p> <ul> <li>Count: Counts the number of data points.</li> <li>Average (Avg): Calculates the arithmetic mean of values.</li> <li>Maximum (Max): Identifies the highest value.</li> <li>Minimum (Min): Identifies the lowest value.</li> <li>Sum: Adds up all the values.</li> </ul> <p>You can select flexible time ranges for graphs from the past 30 minutes to the last 30 days, or custom ranges. You can specify time interval granularity from one minute to one month.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-a-metrics-graph","title":"Create a metrics graph","text":"<p>To create a Metrics Explorer graph that shows host VM maximum percentage CPU and inbound flows together for the past 30 minutes:</p> <ol> <li> <p>Open\u00a0Metrics Explorer\u00a0by selecting\u00a0See all Metrics\u00a0on the VM's\u00a0Monitoring\u00a0tab or selecting\u00a0Metrics\u00a0from the VM's left navigation menu.</p> </li> <li> <p>Scope\u00a0and\u00a0Metric Namespace\u00a0are already populated for the host VM. Select\u00a0Percentage CPU\u00a0from the\u00a0Metrics\u00a0dropdown list.</p> </li> <li> <p>Aggregation\u00a0is automatically populated with\u00a0Avg, but change it to\u00a0Max.</p> <p></p> </li> <li> <p>Select\u00a0Add metric\u00a0at upper left.</p> </li> <li> <p>Under\u00a0Metric, select\u00a0Inbound Flows. Leave\u00a0Aggregation\u00a0at\u00a0Avg.</p> </li> <li> <p>At upper right, select\u00a0Local Time: Last 24 hours (Automatic - 15 minutes), change it to\u00a0Last 30 minutes, and select\u00a0Apply.</p> </li> </ol> <p>Your graph should look similar to the following screenshot:</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#collect-client-performance-counters-by-using-vm-insights","title":"Collect client performance counters by using VM insights","text":"<p>Besides monitoring your VM host's health, utilization, and performance, you need to monitor the software and processes running on your VM. These are called the VM guest or client. In this unit, you enable the Azure Monitor VM insights feature, which offers a quick way to start monitoring the VM client.</p> <p>The VM client includes the operating system and other workloads and applications. To monitor the software running on your VM, you install the Azure Monitor Agent, which collects data from inside the VM. VM insights:</p> <ul> <li>Installs Azure Monitor Agent on your VM.</li> <li>Creates a DCR that collects and sends a predefined set of client performance data to a Log Analytics workspace.</li> <li>Presents the data in curated workbooks.</li> </ul> <p>Although you don't need to use VM insights to install Azure Monitor Agent, create DCRs, or set up workbooks, VM insights makes setting up VM client monitoring easy. VM insights provides you with a basis for monitoring the performance of your VM client and mapping the processes running on your machine.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#enable-vm-insights","title":"Enable VM insights","text":"<ol> <li> <p>In the Azure portal, on your VM's\u00a0Overview\u00a0page, select\u00a0Insights\u00a0from the left navigation menu under\u00a0Monitoring.</p> </li> <li> <p>On the\u00a0Insights\u00a0page, select\u00a0Enable.</p> </li> <li> <p>Under\u00a0Data collection rule, note the properties of the DCR that VM insights creates. In the DCR description,\u00a0Processes and dependencies (Map)\u00a0is set to\u00a0Disabled, which you can change to\u00a0Enabled\u00a0or review\u00a0this article on how-to\u00a0if greyed out. Also a default\u00a0Log Analytics workspace\u00a0is created or assigned.</p> </li> <li> <p>Select\u00a0Configure.</p> <p></p> <p>Configuration of the workspace and the agent installation typically takes 5 to 10 minutes. It can take another 5 to 10 minutes for data to become available to view in the portal.</p> </li> <li> <p>When the deployment finishes, confirm that the Azure Monitor Agent is installed by looking on the\u00a0Properties\u00a0tab of the VM's\u00a0Overview\u00a0page under\u00a0Extensions + applications.</p> <p>On the\u00a0Monitoring\u00a0tab of the\u00a0Overview\u00a0page, under\u00a0Performance and utilization, you can see that\u00a0Guest OS metrics\u00a0are now being collected.</p> <p></p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#view-vm-insights","title":"View VM insights","text":"<p>VM insights creates a DCR that sends client VM performance counters to Azure Monitor Logs. Because the DCR sends its metrics to Azure Monitor Logs, you don't use Metrics Explorer to view the metrics data that VM insights collects.</p> <p>To view the VM insights performance graphs and maps:</p> <ol> <li> <p>Select\u00a0Insights\u00a0from the VM's left navigation menu under\u00a0Monitoring.</p> </li> <li> <p>Near the top of the\u00a0Insights\u00a0page, select the\u00a0Performance\u00a0tab. The prebuilt VM insights Performance workbook shows charts and graphs with performance-related data for the current VM.</p> <p></p> <ul> <li> <p>You can customize the view by specifying a different\u00a0Time range\u00a0at the top of the page and different aggregations at the top of each graph.</p> </li> <li> <p>Select\u00a0View Workbooks\u00a0to select from other available prebuilt VM insights workbooks. Select\u00a0Go To Gallery\u00a0to select from a gallery of other VM insights workbooks and workbook templates, or to edit and create your own workbooks.</p> </li> </ul> </li> <li> <p>If enabled earlier, select the\u00a0Map\u00a0tab on the\u00a0Insights\u00a0page to see the workbook for the Map feature. The map visualizes the VM's dependencies by discovering running process groups and processes that have active network connections over a specified time range.</p> <p></p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#collect-vm-client-event-logs","title":"Collect VM client event logs","text":"<p>Azure Monitor Metrics and VM insights performance counters help you identify performance anomalies, and alert when thresholds are reached. But to analyze the root causes of issues you detect, you need to analyze log data to see which system events caused or contributed to the issues. In this unit, you set up a DCR to collect Linux VM Syslog data, and view the log data in Azure Monitor Log Analytics by using a simple Kusto Query Language (KQL) query.</p> <p>VM insights installs the Azure Monitor Agent, and creates a DCR that collects predefined performance counters, maps process dependencies, and presents the data in prebuilt workbooks. You can create your own DCRs to collect VM performance counters that the VM insights DCR doesn't collect, or to collect log data.</p> <p>When you create DCRs in the Azure portal, you can select from a range of performance counters and sampling rates or add custom performance counters. Alternatively, you can select from a predefined set of log types and severity levels or define custom log schemas. You can associate a single DCR to any or all VMs in your subscription, but you might need multiple DCRs to collect different types of data from different VMs.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-a-dcr-to-collect-log-data","title":"Create a DCR to collect log data","text":"<p>In the Azure portal, search for and select\u00a0monitor\u00a0to go to the Azure Monitor\u00a0Overview\u00a0page.</p> <p></p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-a-data-collection-endpoint","title":"Create a Data Collection Endpoint","text":"<p>You must have a data collection endpoint to send log data to. To create an endpoint:</p> <ol> <li>In the Azure Monitor left navigation menu under\u00a0Settings, select\u00a0Data Collection Endpoints.</li> <li>On the\u00a0Data Collection Endpoints\u00a0page, select\u00a0Create.</li> <li>On the\u00a0Create data collection endpoint\u00a0page, for\u00a0Name, enter\u00a0linux-logs-endpoint.</li> <li>Select the same\u00a0Subscription,\u00a0Resource group, and\u00a0Region\u00a0as your VM uses.</li> <li>Select\u00a0Review + create, and when validation passes, select\u00a0Create.</li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#create-the-data-collection-rule","title":"Create the Data Collection Rule","text":"<p>To create the DCR to collect the event logs:</p> <ol> <li> <p>In the Monitor left navigation menu under\u00a0Settings, select\u00a0Data Collection Rules.</p> </li> <li> <p>On the\u00a0Data Collection Rules\u00a0page, you can see the DCR that VM insights created. Select\u00a0Create\u00a0to create a new data collection rule.</p> <p></p> </li> <li> <p>On the\u00a0Basics\u00a0tab of the\u00a0Create Data Collection Rule\u00a0screen, provide the following information:</p> <ul> <li>Rule name: Enter\u00a0collect-events-linux.</li> <li>Subscription,\u00a0Resource Group, and\u00a0Region: Select the same as for your VM.</li> <li>Platform Type: Select\u00a0Linux.</li> <li>Select\u00a0Next: Resources\u00a0or the\u00a0Resources\u00a0tab.</li> </ul> <p></p> </li> <li> <p>On the\u00a0Resources\u00a0screen, select\u00a0Add resources.</p> </li> <li> <p>On the\u00a0Select a scope\u00a0screen, select the\u00a0monitored-linux-vm\u00a0VM, and then select\u00a0Apply.</p> </li> <li> <p>On the\u00a0Resources\u00a0screen, select\u00a0Enable Data Collection Endpoints.</p> </li> <li> <p>Under\u00a0Data collection endpoint\u00a0for the\u00a0monitored-linux-vm, select the\u00a0linux-logs-endpoint\u00a0you created.</p> </li> <li> <p>Select\u00a0Next: Collect and deliver, or the\u00a0Collect and deliver\u00a0tab.</p> <p></p> </li> <li> <p>On the\u00a0Collect and deliver\u00a0tab, select\u00a0Add data source.</p> </li> <li> <p>On the\u00a0Add data source\u00a0screen, under\u00a0Data source type, select\u00a0Linux Syslog.</p> </li> <li> <p>On the\u00a0Add data source\u00a0screen, select\u00a0Next: Destination\u00a0or the\u00a0Destination\u00a0tab, and make sure the\u00a0Account or namespace\u00a0matches the Log Analytics workspace that you want to use. You can use the default Log Analytics workspace that VM insights set up, or create or use another Log Analytics workspace.</p> </li> <li> <p>On the\u00a0Add data source\u00a0screen, select\u00a0Add data source.</p> </li> <li> <p>On the\u00a0Create Data Collection Rule\u00a0screen, select\u00a0Review + create, and when validation passes, select\u00a0Create.</p> <p></p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#view-log-data","title":"View log data","text":"<p>You can view and analyze the log data collected by your DCR by using KQL log queries. A set of sample KQL queries is available for VMs, but you can write a query to look at the events your DCR is collecting.</p> <ol> <li> <p>On your VM's\u00a0Overview\u00a0page, select\u00a0Logs\u00a0from the left navigation menu under\u00a0Monitoring. Log Analytics opens an empty query window with the scope set to your VM.</p> <p>You can also access log data by selecting\u00a0Logs\u00a0from the left navigation of the Azure Monitor\u00a0Overview\u00a0page. If necessary, select\u00a0Select scope\u00a0at the top of the query window to scope the query to the desired Log Analytics workspace and VM.</p> <p>Note</p> <p>The\u00a0Queries\u00a0window with sample queries might open when you open Log Analytics. For now, close this window, because you're going to manually create a simple query.</p> </li> <li> <p>In the empty query window, type\u00a0Syslog, and then select\u00a0Run. All the system log events the DCR collected within the\u00a0Time range\u00a0are displayed.</p> </li> <li> <p>You can refine your query to identify events of interest. For example, you can display only the events that had a\u00a0SeverityLevel\u00a0of\u00a0warning.</p> <p></p> </li> </ol>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Monitor%20and%20backup%20azure%20resources/#summary","title":"Summary","text":"<p>Azure Monitor helps you collect, analyze, and alert on various types of host and client monitoring data from your Azure VMs.</p> <ul> <li>Azure Monitor provides a set of VM host logs and performance and usage metrics for all Azure VMs.</li> <li>You can enable recommended alert rules when you create VMs or afterwards to alert on important VM host metrics.</li> <li>Azure Monitor Metrics Explorer lets you graph and analyze metrics for Azure VMs and other resources.</li> <li>VM insights provides a simple way to monitor important VM client performance counters and processes running on your VM.</li> <li>You can create data collection rules to collect other metrics and logs from your VM client.</li> <li>You can use Log Analytics to query and analyze log data.</li> </ul> <p>Now that you understand these tools, you're confident that Azure Monitor can effectively monitor your Azure VMs and help you keep your website running effectively.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/","title":"Introduction to Azure Cloud Shell","text":"<p>Azure Cloud Shell is a command-line environment you can access through your web browser. You can use this environment to manage Azure resources, including VMs, storage, and networking. Just like you do when using the Azure CLI or Azure PowerShell.</p> <p>Because Microsoft manages Cloud Shell, you always have access to the most recent versions of the Azure CLI and PowerShell modules right from any browser. You don't have to worry about keeping modules up to date. With Cloud Shell, you just open your browser and sign in. Just like that, you have access to a command-line environment fully connected with your account's permissions and the resources to which you have access. All that works in an infrastructure that's compliant with double encryption at rest by default. You don't need to take any further action!</p> <p>Azure Cloud Shell also provides cloud storage to persist files such as SSH keys, scripts, and more. This functionality lets you access important files in between sessions and with different machines. Finally, you can use the Cloud Shell editor to make changes to files, such as scripts, that are saved into this cloud storage directly from the Cloud Shell interface.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#how-does-azure-cloud-shell-work","title":"How does Azure Cloud Shell work?","text":"<p>As an IT admin for Contoso Corporation, you're frequently on-call to perform administrative tasks and resolve workload disruptions to resources in your organization's Azure subscriptions. When visiting a family member during a weekend that you're on call, the development team notifies you of a problem with an Azure virtual machine (VM). The VM became nonresponsive during scheduled maintenance for the upgrade of an application that runs on it. Because the developers weren't granted access to the underlying Azure virtual machine hosting infrastructure, they're only able to remotely access the VM when it's operating normally. So, you're being called to diagnose and remediate the problem.</p> <p>Since you're visiting family, you don\u2019t have access to your administrative workstation and diagnostic scripts. You do have access to a laptop with an internet browser. Using the laptop, you browse to the Azure portal, authenticate against your organization\u2019s Azure subscription, open Azure Cloud Shell, mount an Azure File Share, access your diagnostic scripts, and diagnose and remediate the problems with the VM, returning it to operation.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#access-cloud-shell","title":"Access Cloud Shell","text":"<p>You have a few different options for accessing Azure Cloud Shell:</p> <ul> <li> <p>From a direct link:\u00a0https://shell.azure.com</p> <p></p> </li> <li> <p>From the Azure portal</p> <p></p> </li> <li> <p>From code snippets when accessing Microsoft Learn:</p> <p></p> </li> </ul> <p>When you open a Cloud Shell session, a temporary host is allocated to your session. This VM is preconfigured with the latest versions of PowerShell and Bash. You can then select the command-line experience you want to use:</p> <p></p> <p>After you select the shell experience you want to use, you can start managing your Azure resources:</p> <p></p> <p>Cloud Shell sessions terminate after 20 minutes of inactivity. When a session terminates, files on your CloudDrive are persisted, but you need to start a new session to access the Cloud Shell environment.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#access-your-own-scripts-and-files","title":"Access your own scripts and files","text":"<p>When using Cloud Shell, you might also need to run scripts or use files for different actions. You can persist files on Cloud Shell by using the Azure CloudDrive:</p> <p></p> <p>After uploading files, you can interact with them as you would in a regular PowerShell or Bash session:</p> <p></p> <p>Now that your file resides on CloudDrive, you can close the session and open another session on a different device and still access the same file. Cloud Shell also lets you map an Azure Storage File Share, which is tied to a specific region. Access to an Azure File Share lets you work with the contents of that share through Cloud Shell.</p> <p>If you need to edit scripts hosted on the CloudDrive or File Share, you can use the Cloud Shell editor. Select the curly brackets {} icon on the browser and open the file you want to edit, or use the command\u00a0<code>code</code>\u00a0and specify the filename; for example:</p> <p>BashCopy</p> <pre><code>code temp.txt\n</code></pre> <p></p> <p>Note</p> <p>The\u00a0<code>code</code>\u00a0command only works in the Classic mode in Cloud Shell. To enable Classic mode, select the\u00a0More\u00a0icon (...), then select\u00a0Settings\u00a0&gt;\u00a0Go to Classic version.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#cloud-shell-tools","title":"Cloud Shell tools","text":"<p>If you need to manage resources (such as Docker containers or Kubernetes Clusters) or want to use non-Microsoft tools (such as Ansible and Terraform) in Cloud Shell, the Cloud Shell session comes with these add-ons already preconfigured.</p> <p>Here\u2019s a list of all add-ons available to you within a Cloud Shell session:</p> <p>Expand table</p> Category Name Linux tools bash  zsh  sh  tmux  dig Azure tools Azure CLI and\u00a0Azure classic CLI AzCopy  Azure Functions CLI  Service Fabric CLI  Batch Shipyard  blobxfer Text editors code (Cloud Shell editor)  vim  nano  emacs Source control git Build tools make  maven  npm  pip Containers Docker Machine  Kubectl  Helm  DC/OS CLI Databases MySQL client  PostgreSql client  sqlcmd Utility  mssql-scripter Other iPython Client  Cloud Foundry CLI  Terraform  Ansible  Chef InSpec  Puppet Bolt  HashiCorp Packer  Office 365 CLI","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#when-should-you-use-azure-cloud-shell","title":"When should you use Azure Cloud Shell?","text":"<p>As an IT Admin for Contoso Corporation, you need alternatives to interact with Azure resources from the command line even when not using your default administrative device.</p> <p>You can use Azure Cloud Shell to:</p> <ul> <li>Open a secure command-line session from any browser-based device.</li> <li>Interact with Azure resources without the need to install plug-ins or add-ons to your device.</li> <li>Persist files between sessions for later use.</li> <li>Use either Bash or PowerShell, whichever you prefer, to manage Azure resources.</li> <li>Edit files (such as scripts) via the Cloud Shell editor.</li> </ul> <p>You shouldn't use Azure Cloud Shell if:</p> <ul> <li>You intend to leave a session open for more than 20 minutes for long running scripts or activities. In these cases, your session is disconnected without warning, and the current state is lost.</li> <li>You need admin permissions, such as sudo access, from within the Azure CLI or PowerShell environment.</li> <li>You need to install tools that aren't supported in the limited Cloud Shell environment, but instead require an environment such as a custom virtual machine or container.</li> <li>You need storage from different regions. You might need to back up and synchronize this content since only one region can have the storage allocated to Azure Cloud Shell.</li> <li>You need to open multiple sessions at the same time. Azure Cloud Shell allows only one instance at time and isn't suitable for concurrent work across multiple subscriptions or tenants.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#introduction-to-bash","title":"Introduction to Bash","text":"","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#introduction","title":"Introduction","text":"<p>Imagine you just started a new job as a system administrator (sysadmin) at Northwind, a high-frequency trading (HFT) firm that runs Windows on its client computers and Linux on its server computers. Computers are the lifeblood of the company, and you need to learn more about how to manage Linux boxes. It's time to skill up!</p> <p>Bash is the standard shell scripting language for Linux. Let's learn the basics of Bash, starting with the syntax and commonly used commands, like\u00a0<code>ls</code>\u00a0and\u00a0<code>cat</code>.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#what-is-bash","title":"What is Bash?","text":"<p>Bash is a vital tool for managing Linux machines. The name is short for \"Bourne\u00a0Again\u00a0Shell.\"</p> <p>A shell is a program that commands the operating system to perform actions. You can enter commands in a console on your computer and run the commands directly, or you can use scripts to run batches of commands. Shells like PowerShell and Bash give system administrators the power and precision they need for fine-tuned control of the computers they're responsible for.</p> <p>There are other Linux shells, including csh and zsh, but Bash became the de facto Linux standard. That's because Bash is compatible with Unix's first serious shell, the Bourne shell, also known as sh. Bash incorporates the best features of its predecessors. But Bash also has some fine features of its own, including built-in commands and the ability to invoke external programs.</p> <p>One reason for Bash's success is its simplicity. Bash, like the rest of Linux, is based on the Unix design philosophy. As Peter Salus summarized in his book\u00a0A Quarter Century of Unix, three of the \"big ideas\" embodied in Unix are:</p> <ul> <li>Programs do one thing and do it well</li> <li>Programs work together</li> <li>Programs use text streams as the universal interface</li> </ul> <p>The last part is key to understanding how Bash works. In Unix and Linux, everything is a file. That means you can use the same commands without worrying about whether the I/O stream\u2014the input and output\u2014comes from a keyboard, a disk file, a socket, a pipe, or another I/O abstraction.</p> <p>Let's learn the basics of Bash, starting with the syntax and commonly used commands, like\u00a0<code>ls</code>\u00a0and\u00a0<code>cat</code>.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#bash-fundamentals","title":"Bash fundamentals","text":"<p>An understanding of Bash starts with an understanding of Bash syntax. After you know the syntax, you can apply it to every Bash command you run.</p> <p>The full syntax for a Bash command is:</p> <p>BashCopy</p> <pre><code>command [options] [arguments]\n</code></pre> <p>Bash treats the first string it encounters as a command. The following command uses Bash's\u00a0<code>ls</code>\u00a0(for \"list\") command to display the contents of the current working directory:</p> <p>BashCopy</p> <pre><code>ls\n</code></pre> <p>Arguments often accompany Bash commands. For example, you can include a path name in an\u00a0<code>ls</code>\u00a0command to list the contents of another directory:</p> <p>BashCopy</p> <pre><code>ls /etc\n</code></pre> <p>Most Bash commands have options for modifying how they work. Options, also called\u00a0flags, give a command more specific instructions. As an example, files and directories whose names begin with a period are hidden from the user and aren't displayed by\u00a0<code>ls</code>. However, you can include the\u00a0<code>-a</code>\u00a0(for \"all\") flag in an\u00a0<code>ls</code>\u00a0command and see everything in the target directory:</p> <p>BashCopy</p> <pre><code>ls -a /etc\n</code></pre> <p>You can even combine flags for brevity. For example, rather than enter\u00a0<code>ls -a -l /etc</code>\u00a0to show all files and directories in Linux's\u00a0/etc\u00a0directory in long form, you can enter this instead:</p> <p>BashCopy</p> <pre><code>ls -al /etc\n</code></pre> <p>Bash is concise. It's sometimes remarkable (and a point of pride among Bash aficionados) how much you can accomplish with a single command.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#get-help","title":"Get help","text":"<p>Which options and arguments can be used, or must be used, varies from command to command. Fortunately, Bash documentation is built into the operating system. Help is never more than a command away. To learn about the options for a command, use the\u00a0<code>man</code>\u00a0(for \"manual\") command. For instance, to see all the options for the\u00a0<code>mkdir</code>\u00a0(\"make directory\") command, do this:</p> <p>BashCopy</p> <pre><code>man mkdir\n</code></pre> <p><code>man</code>\u00a0is your best friend as you learn Bash.\u00a0<code>man</code>\u00a0is how you find the information you need to understand how any command works.</p> <p>Most Bash and Linux commands support the\u00a0<code>--help</code>\u00a0option. This shows a description of the command's syntax and options. To demonstrate, enter\u00a0<code>mkdir --help</code>. The output looks something like this:</p> <p>OutputCopy</p> <pre><code>Usage: mkdir [OPTION]... DIRECTORY...\nCreate the DIRECTORY(ies), if they do not already exist.\n\nMandatory arguments to long options are mandatory for short options too.\n  -m, --mode=MODE   set file mode (as in chmod), not a=rwx - umask\n  -p, --parents     no error if existing, make parent directories as needed\n  -v, --verbose     print a message for each created directory\n  -Z                   set SELinux security context of each created directory\n                         to the default type\n      --context[=CTX]  like -Z, or if CTX is specified then set the SELinux\n                         or SMACK security context to CTX\n      --help     display this help and exit\n      --version  output version information and exit\n\nGNU coreutils online help: &lt;http://www.gnu.org/software/coreutils/&gt;\nReport mkdir translation bugs to &lt;http://translationproject.org/team/&gt;\nFull documentation at: &lt;http://www.gnu.org/software/coreutils/mkdir&gt;\nor available locally via: info '(coreutils) mkdir invocation'\n</code></pre> <p>Help obtained this way is typically more concise than help obtained with\u00a0<code>man</code>.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#use-wildcards","title":"Use wildcards","text":"<p>Wildcards are symbols that represent one or more characters in Bash commands. The most frequently used wildcard is the asterisk. It represents zero characters or a sequence of characters. Suppose your current directory contains hundreds of image files, but you only want to see the PNG files; the ones whose file names end with\u00a0.png. Here's the command to list only those files:</p> <p>BashCopy</p> <pre><code>ls *.png\n</code></pre> <p>Note</p> <p>Linux has no formal concept of a file-name extension as other operating systems do. This doesn't mean that PNG files won't have a\u00a0.png\u00a0extension. It simply means Linux attaches no special significance to the fact that the file names end with\u00a0.png.</p> <p>Now let's say the current directory also contains JPEG files. Some end in\u00a0.jpg, while others end in\u00a0.jpeg.\u00a0Here's one way to list all the JPEG files:</p> <p>BashCopy</p> <pre><code>ls *.jpg *.jpeg\n</code></pre> <p>And here's another:</p> <p>BashCopy</p> <pre><code>ls *.jp*g\n</code></pre> <p>The\u00a0<code>*</code>\u00a0wildcard matches on zero or more characters, but the\u00a0<code>?</code>\u00a0wildcard represents a single character. If the current directory contains files named\u00a00001.jpg,\u00a00002.jpg, and so on through\u00a00009.jpg, the following command lists them all:</p> <p>BashCopy</p> <pre><code>ls 000?.jpg\n</code></pre> <p>Yet another way to use wildcards to filter output is to use square brackets, which denote groups of characters. The following command lists all the files in the current directory whose names contain a period immediately followed a lowercase J or P. It lists all the\u00a0.jpg,\u00a0.jpeg, and\u00a0.png\u00a0files, but not\u00a0.gif\u00a0files:</p> <p>BashCopy</p> <pre><code>ls *.[jp]*\n</code></pre> <p>In Linux, file names and the commands that operate upon them are case-sensitive. So to list all the files in the current directory whose names contain periods followed by an uppercase\u00a0or\u00a0lowercase J or P, you could enter this:</p> <p>BashCopy</p> <pre><code>ls *.[jpJP]*\n</code></pre> <p>Expressions in square brackets can represent ranges of characters. For example, the following command lists all the files in the current directory whose names begin with a lowercase letter:</p> <p>BashCopy</p> <pre><code>ls [a-z]*\n</code></pre> <p>This command, by contrast, lists all the files in the current directory whose names begin with an uppercase letter:</p> <p>BashCopy</p> <pre><code>ls [A-Z]*\n</code></pre> <p>And this one lists all the files in the current directory whose names begin with a lowercase\u00a0or\u00a0uppercase letter:</p> <p>BashCopy</p> <pre><code>ls [a-zA-Z]*\n</code></pre> <p>Based on all this, can you guess what the following commands do?</p> <p>BashCopy</p> <pre><code>ls [0-9]*\nls *[0-9]*\nls *[0-9]\n</code></pre> <p>If you need to use one of the wildcard characters as an ordinary character, you make it literal or \"escape it\" by prefacing it with a backslash. So, if for some reason you had an asterisk as part of a file name\u2014something you should never do intentionally\u2014you could search for it by using a command such as:</p> <p>BashCopy</p> <pre><code>$ ls *\\**\n</code></pre>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#bash-commands-and-operators","title":"Bash commands and operators","text":"<p>Every shell language has its most-used commands. Let's start building your Bash repertoire by examining the most commonly used commands.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#bash-commands","title":"Bash commands","text":"<p>Let's look at common Bash commands and how to use them.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#ls-command","title":"<code>ls</code>\u00a0command","text":"<p><code>ls</code>\u00a0lists the contents of your current directory or the directory specified in an argument to the command. By itself, it lists the files and directories in the current directory:</p> <p>BashCopy</p> <pre><code>ls\n</code></pre> <p>Files and directories whose names begin with a period are hidden by default. To include these items in a directory listing, use an\u00a0<code>-a</code>\u00a0flag:</p> <p>BashCopy</p> <pre><code>ls -a\n</code></pre> <p>To get even more information about the files and directories in the current directory, use an\u00a0<code>-l</code>\u00a0flag:</p> <p>BashCopy</p> <pre><code>ls -l\n</code></pre> <p>Here's some sample output from a directory that contains a handful of JPEGs and PNGs and a subdirectory named\u00a0gifs:</p> <p>OutputCopy</p> <pre><code>-rw-rw-r-- 1 azureuser azureuser  473774 Jun 13 15:38 0001.png\n-rw-rw-r-- 1 azureuser azureuser 1557965 Jun 13 14:43 0002.jpg\n-rw-rw-r-- 1 azureuser azureuser  473774 Mar 26 09:21 0003.png\n-rw-rw-r-- 1 azureuser azureuser 4193680 Jun 13 09:40 0004.jpg\n-rw-rw-r-- 1 azureuser azureuser  423325 Jun 10 12:53 0005.jpg\n-rw-rw-r-- 1 azureuser azureuser 2278001 Jun 12 04:21 0006.jpg\n-rw-rw-r-- 1 azureuser azureuser 1220517 Jun 13 14:44 0007.jpg\ndrwxrwxr-x 2 azureuser azureuser    4096 Jun 13 20:16 gifs\n</code></pre> <p>Each line provides detailed information about the corresponding file or directory. That information includes the permissions assigned to it, its owner, its size in bytes, the last time it was modified, and the file or directory name.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#cat-command","title":"<code>cat</code>\u00a0command","text":"<p>Suppose you want to see what's inside a file. You can use the\u00a0<code>cat</code>\u00a0command for that. The output won't make much sense unless the file is a text file. The following command shows the contents of the\u00a0os-release\u00a0file stored in the\u00a0/etc\u00a0directory:</p> <p>BashCopy</p> <pre><code>cat /etc/os-release\n</code></pre> <p>This is a useful command because it tells you which Linux distribution you're running:</p> <p>OutputCopy</p> <pre><code>NAME=\"Ubuntu\"\nVERSION=\"18.04.2 LTS (Bionic Beaver)\"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME=\"Ubuntu 18.04.2 LTS\"\nVERSION_ID=\"18.04\"\nHOME_URL=\"https://www.ubuntu.com/\"\nSUPPORT_URL=\"https://help.ubuntu.com/\"\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\nVERSION_CODENAME=bionic\nUBUNTU_CODENAME=bionic\n</code></pre> <p>The\u00a0/etc\u00a0directory is a special one in Linux. It contains system-configuration files. You don't want to delete any files from this directory unless you know what you're doing.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#sudo-command","title":"<code>sudo</code>\u00a0command","text":"<p>Some Bash commands can only be run by the root user; a system administrator or superuser. If you try one of these commands without sufficient privileges, it fails. For example, only users logged in as a superuser can use\u00a0<code>cat</code>\u00a0to display the contents of\u00a0/etc/at.deny:</p> <p>BashCopy</p> <pre><code>cat /etc/at.deny\n</code></pre> <p>at.deny\u00a0is a special file that determines who can use other Bash commands to submit jobs for later execution.</p> <p>You don't want to run as root most of the time; it's too dangerous. To run commands that require admin privilege without logging in as a superuser, you'll preface the commands with\u00a0<code>sudo</code>:</p> <p>BashCopy</p> <pre><code>sudo cat /etc/at.deny\n</code></pre> <p><code>sudo</code>\u00a0stands for \"superuser do.\" When you use it, you're telling the shell that for this one command, you're acting with the root-user level of permission.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#cd-mkdir-and-rmdir-commands","title":"<code>cd</code>,\u00a0<code>mkdir</code>, and\u00a0<code>rmdir</code>\u00a0commands","text":"<p><code>cd</code>\u00a0stands for \"change directory,\" and it does exactly what the name suggests: it changes the current directory to another directory. It enables you to move from one directory to another just like its counterpart in Windows. The following command changes to a subdirectory of the current directory named\u00a0orders:</p> <p>BashCopy</p> <pre><code>cd orders\n</code></pre> <p>You can move up a directory by specifying\u00a0<code>..</code>\u00a0as the directory name:</p> <p>BashCopy</p> <pre><code>cd ..\n</code></pre> <p>This command changes to your home directory; the one you land in when you first sign in:</p> <p>BashCopy</p> <pre><code>cd ~\n</code></pre> <p>You can create directories by using the\u00a0<code>mkdir</code>\u00a0command. The following command creates a subdirectory named\u00a0orders\u00a0in the current working directory:</p> <p>BashCopy</p> <pre><code>mkdir orders\n</code></pre> <p>If you want to create a subdirectory and another subdirectory under it with one command, use the\u00a0<code>--parents</code>\u00a0flag:</p> <p>BashCopy</p> <pre><code>mkdir --parents orders/2019\n</code></pre> <p>The\u00a0<code>rmdir</code>\u00a0command deletes (removes) a directory, but only if it's empty. If it's not empty, you get a warning instead. Fortunately, you can use the\u00a0<code>rm</code>\u00a0command to delete directories that aren't empty in combination with the\u00a0<code>-r</code>\u00a0(recursive) flag. The command would then look like so,\u00a0<code>rm -r</code>.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#rm-command","title":"<code>rm</code>\u00a0command","text":"<p>The\u00a0<code>rm</code>\u00a0command is short for \"remove.\" As you'd expect,\u00a0<code>rm</code>\u00a0deletes files. So this command puts an end to\u00a00001.jpg:</p> <p>BashCopy</p> <pre><code>rm 0001.jpg\n</code></pre> <p>And this command deletes all the files in the current directory:</p> <p>BashCopy</p> <pre><code>rm *\n</code></pre> <p>Be wary of\u00a0<code>rm</code>. It's a dangerous command.</p> <p>Running\u00a0<code>rm</code>\u00a0with a\u00a0<code>-i</code>\u00a0flag lets you think before you delete:</p> <p>BashCopy</p> <pre><code>rm -i *\n</code></pre> <p>Make it a habit to include\u00a0<code>-i</code>\u00a0in every\u00a0<code>rm</code>\u00a0command, and you might avoid falling victim to one of Linux's biggest blunders. The dreaded\u00a0<code>rm -rf /</code>\u00a0command deletes every file on an entire drive. It works by recursively deleting all the subdirectories of root and their subdirectories. The\u00a0<code>-f</code>\u00a0(for \"force\") flag compounds the problem by suppressing prompts.\u00a0Don't do this.</p> <p>If you want to delete a subdirectory named\u00a0orders\u00a0that isn't empty, you can use the\u00a0<code>rm</code>\u00a0command this way:</p> <p>BashCopy</p> <pre><code>rm -r orders\n</code></pre> <p>This deletes the\u00a0orders\u00a0subdirectory and everything in it, including other subdirectories.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#cp-command","title":"<code>cp</code>\u00a0command","text":"<p>The\u00a0<code>cp</code>\u00a0command copies not just files, but entire directories (and subdirectories) if you want. To make a copy of\u00a00001.jpg\u00a0named\u00a00002.jpg, use this command:</p> <p>BashCopy</p> <pre><code>cp 0001.jpg 0002.jpg\n</code></pre> <p>If\u00a00002.jpg\u00a0already exists, Bash silently replaces it. That's great if it's what you intended, but not so wonderful if you didn't realize you were about to overwrite the old version.</p> <p>Fortunately, if you use the\u00a0<code>-i</code>\u00a0(for \"interactive\") flag, Bash warns you before deleting existing files. This is safer:</p> <p>BashCopy</p> <pre><code>cp -i 0001.jpg 0002.jpg\n</code></pre> <p>You can use wildcards to copy several files at once. To copy all the files in the current directory to a subdirectory named\u00a0photos, do this:</p> <p>BashCopy</p> <pre><code>cp * photos\n</code></pre> <p>To copy all the files in a subdirectory named\u00a0photos\u00a0into a subdirectory named\u00a0images, do this:</p> <p>BashCopy</p> <pre><code>cp photos/* images\n</code></pre> <p>This assumes that the\u00a0images\u00a0directory already exists. If it doesn't, you can create it\u00a0and\u00a0copy the contents of the\u00a0photos\u00a0directory by using this command:</p> <p>BashCopy</p> <pre><code>cp -r photos images\n</code></pre> <p>The\u00a0<code>-r</code>\u00a0stands for \"recursive.\" An added benefit of the\u00a0<code>-r</code>\u00a0flag is that if\u00a0photos\u00a0contains subdirectories of its own, they too are copied to the\u00a0images\u00a0directory.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#ps-command","title":"<code>ps</code>\u00a0command","text":"<p>The\u00a0<code>ps</code>\u00a0command gives you a snapshot of all the currently running processes. By itself, with no arguments, it shows all your shell processes; in other words, not much. But it's a different story when you include a\u00a0<code>-e</code>\u00a0flag:</p> <p>BashCopy</p> <pre><code>ps -e\n</code></pre> <p><code>-e</code>\u00a0lists\u00a0all\u00a0running processes, and there are typically many of them.</p> <p>For a more comprehensive look at what processes are running in the system, use the\u00a0<code>-ef</code>\u00a0flag:</p> <p>BashCopy</p> <pre><code>ps -ef \n</code></pre> <p>This flag shows the names of all the running processes, their process identification numbers (PIDs), the PIDs of their parents (PPIDs), and when they began (STIME). It also shows what terminal, if any, they're attached to (TTY), how much CPU time they've racked up (TIME), and their full path names. Here's an abbreviated example:</p> <p>Copy</p> <pre><code>UID         PID   PPID  C STIME TTY          TIME CMD\nroot          1      0  0 13:35 ?        00:00:03 /sbin/init\nroot          2      0  0 13:35 ?        00:00:00 [kthreadd]\nroot          3      2  0 13:35 ?        00:00:00 [rcu_gp]\nroot          4      2  0 13:35 ?        00:00:00 [rcu_par_gp]\nroot          5      2  0 13:35 ?        00:00:00 [kworker/0:0-cgr]\nroot          6      2  0 13:35 ?        00:00:00 [kworker/0:0H-kb]\nroot          8      2  0 13:35 ?        00:00:00 [mm_percpu_wq]\nroot          9      2  0 13:35 ?        00:00:01 [ksoftirqd/0]\nroot         10      2  0 13:35 ?        00:00:02 [rcu_sched]\n</code></pre> <p>As an aside, you might find documentation that shows\u00a0<code>ps</code>\u00a0being used this way:</p> <p>BashCopy</p> <pre><code>ps aux\n</code></pre> <p><code>ps aux</code>\u00a0and\u00a0<code>ps -ef</code>\u00a0are the same. This duality traces back to historical differences between POSIX Unix systems (of which Linux is one) and BSD Unix systems (the most common of which is macOS). In the beginning, POSIX used\u00a0<code>-ef</code>\u00a0while the BSD required\u00a0<code>aux</code>. Today, both operating-system families accept either format.</p> <p>This serves as an excellent reminder of why you should look closely at the manual for all Linux commands. Learning Bash is like learning English as a second language. There are many exceptions to the rules.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#w-command","title":"<code>w</code>\u00a0command","text":"<p>Users come, users go, and sometimes you get users you don't want at all. When an employee leaves to pursue other opportunities, the sysadmin is called upon to ensure that the worker can no longer sign in to the company's computer systems. Sysadmins are also expected to know who's logged in, and who shouldn't be.</p> <p>To find out who's on your servers, Linux provides the\u00a0<code>w</code>\u00a0(for \"who\") command. It displays information about the users currently on the computer system and those users' activities.\u00a0<code>w</code>\u00a0shows user names, their IP addresses, when they logged in, what processes they're currently running, and how much time those processes are consuming. It's a valuable tool for sysadmins.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#bash-io-operators","title":"Bash I/O operators","text":"<p>You can do a lot in Linux just by exercising Bash commands and their many options. But you can really get work done when you combine commands by using I/O operators:</p> <ul> <li><code>&lt;</code>\u00a0for redirecting input to a source other than the keyboard</li> <li><code>&gt;</code>\u00a0for redirecting output to destination other than the screen</li> <li><code>&gt;&gt;</code>\u00a0for doing the same, but appending rather than overwriting</li> <li><code>|</code>\u00a0for piping output from one command to the input of another</li> </ul> <p>Suppose you want to list everything in the current directory but capture the output in a file named\u00a0listing.txt. The following command does just that:</p> <p>BashCopy</p> <pre><code>ls &gt; listing.txt\n</code></pre> <p>If\u00a0listing.txt\u00a0already exists, it gets overwritten. If you use the\u00a0<code>&gt;&gt;</code>\u00a0operator instead, the output from\u00a0<code>ls</code>\u00a0is appended to what's already in\u00a0listing.txt:</p> <p>BashCopy</p> <pre><code>ls &gt;&gt; listing.txt\n</code></pre> <p>The piping operator is powerful (and often used). It redirects the output of the first command to the input of the second command. Let's say you use\u00a0<code>cat</code>\u00a0to display the contents of a large file, but the content scrolls by too quickly for you to read. You can make the output more manageable by piping the results to another command such as\u00a0<code>more</code>. The following command lists all the currently running processes. But once the screen is full, the output pauses until you select\u00a0Enter\u00a0to show the next line:</p> <p>BashCopy</p> <pre><code>ps -ef | more\n</code></pre> <p>You can also pipe output to\u00a0<code>head</code>\u00a0to see just the first several lines:</p> <p>BashCopy</p> <pre><code>ps -ef | head\n</code></pre> <p>Or suppose you want to filter the output to include only the lines that contain the word \"daemon.\" One way to do that is by piping the output from\u00a0<code>ps</code>\u00a0to Linux's useful\u00a0<code>grep</code>\u00a0tool:</p> <p>BashCopy</p> <pre><code>ps -ef | grep daemon\n</code></pre> <p>The output might look like this:</p> <p>OutputCopy</p> <pre><code>azureus+  52463  50702  0 23:28 pts/0    00:00:00 grep --color=auto deamon\nazureuser@bash-vm:~$ ps -ef | grep daemon\nroot        449      1  0 13:35 ?        00:00:17 /usr/lib/linux-tools/4.18.0-1018-azure/hv_kvp_daemon -n\nroot        988      1  0 13:35 ?        00:00:00 /usr/lib/accountsservice/accounts-daemon\nmessage+   1002      1  0 13:35 ?        00:00:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\ndaemon     1035      1  0 13:35 ?        00:00:00 /usr/sbin/atd -f\nroot       1037      1  0 13:35 ?        00:00:00 /usr/bin/python3 -u /usr/sbin/waagent -daemon\nroot       1039      1  0 13:35 ?        00:00:00 /usr/lib/linux-tools/4.18.0-1018-azure/hv_vss_daemon -n\nazureus+  52477  50702  0 23:28 pts/0    00:00:00 grep --color=auto daemon\n</code></pre> <p>You can also use files as input. By default, standard input comes from the keyboard, but it too can be redirected. To get input from a file instead of the keyboard, use the\u00a0<code>&lt;</code>\u00a0operator. One common sysadmin task is to sort the contents of a file. As the name suggests,\u00a0<code>sort</code>\u00a0sorts text in alphabetical order:</p> <p>BashCopy</p> <pre><code>sort &lt; file.txt\n</code></pre> <p>To save the sorted results to a new file, you can redirect input\u00a0and\u00a0output:</p> <p>BashCopy</p> <pre><code>sort &lt; file.txt &gt; sorted_file.txt\n</code></pre> <p>You can use I/O operators to chain Linux commands as needed. Consider the following command:</p> <p>BashCopy</p> <pre><code>cat file.txt | fmt | pr | lpr\n</code></pre> <p>The output from\u00a0<code>cat</code>\u00a0goes to\u00a0<code>fmt</code>, the output from\u00a0<code>fmt</code>\u00a0goes to\u00a0<code>pr</code>, and so on.\u00a0<code>fmt</code>\u00a0formats the results into a tidy paragraph.\u00a0<code>pr</code>\u00a0paginates the results. And\u00a0<code>lpr</code>\u00a0sends the paginated output to the printer. All in a single line!</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#introduction-to-powershell","title":"Introduction to PowerShell","text":"<p>PowerShell is a command-line shell and a scripting language all in one. It was designed as a task engine that uses cmdlets to wrap tasks that people need to do. In PowerShell, you can run commands on local or remote machines. You can do tasks like managing users and automating workflows.</p> <p>Whether you're part of an operations team or a development team that's adopting DevOps principles, PowerShell can help. You can use it to address various tasks, such as managing cloud resources and continuous integration and continuous delivery (CI/CD). PowerShell offers many helpful commands, but you can expand its capabilities at any time by installing modules.</p> <p>When you install PowerShell, you can evaluate its features to see if it's a good fit for your team.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#what-is-powershell","title":"What is PowerShell?","text":"<p>PowerShell consists of two parts: a command-line shell and a scripting language. It started out as a framework to automate administrative tasks in Windows. PowerShell has grown into a cross-platform tool that's used for many kinds of tasks.</p> <p>A command-line shell lacks a graphical interface, where you use a mouse to interact with graphical elements. Instead, you type text commands into a computer console. Here are some of the benefits of using a console:</p> <ul> <li>Interacting with a console is often faster than using a graphical interface.</li> <li>In a console, you can run batches of commands, so it's ideal for task automation for continuous-integration pipelines.</li> <li>You can use a console to interact with cloud resources and other resources.</li> <li>You can store commands and scripts in a text file and use a source-control system. This capability is probably one of the biggest benefits, because your commands are repeatable and auditable. In many systems, especially government systems, everything must be traced and evaluated, or\u00a0audited. Audits cover everything from database changes to changes done by a script.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#features","title":"Features","text":"<p>PowerShell shares some features with traditional shells:</p> <ul> <li>Built-in help system: Most shells have some kind of help system, in which you can learn more about a command. For example, you can learn what the command does and what parameters it supports. The help system in PowerShell provides information about commands and also integrates with online help articles.</li> <li>Pipeline: Traditional shells use a pipeline to run many commands sequentially. The output of one command is the input for the next command. PowerShell implements this concept like traditional shells, but it differs because it operates on objects over text. You learn more about this feature later in this module.</li> <li>Aliases: Aliases are alternate names that can be used to run commands. PowerShell supports the use of common aliases such as\u00a0<code>cls</code>\u00a0(clear the screen) and\u00a0<code>ls</code>\u00a0(list the files). Therefore, new users can use their knowledge of other frameworks and don't necessarily have to remember the PowerShell name for familiar commands.</li> </ul> <p>PowerShell differs from a traditional command-line shell in a few ways:</p> <ul> <li>It operates on objects over text.\u00a0In a command-line shell, you have to run scripts whose output and input might differ, so you end up spending time formatting the output and extracting the data you need. By contrast, in PowerShell you use objects as input and output. That means you spend less time formatting and extracting.</li> <li>It has cmdlets.\u00a0Commands in PowerShell are called cmdlets (pronounced\u00a0commandlets). In PowerShell, cmdlets are built on a common runtime rather than separate executables as they are in many other shell environments. This characteristic provides a consistent experience in parameter parsing and pipeline behavior. Cmdlets typically take object input and return objects. The core cmdlets in PowerShell are built in .NET Core, and are open source. You can extend PowerShell by using more cmdlets, scripts, and functions from the community and other sources, or you can build your own cmdlets in .NET Core or PowerShell.</li> <li>It has many types of commands.\u00a0Commands in PowerShell can be native executables, cmdlets, functions, scripts, or aliases. Every command you run belongs to one of these types. The words\u00a0command\u00a0and\u00a0cmdlet\u00a0are often used interchangeably, because a cmdlet is a type of command.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#installation","title":"Installation","text":"<p>In this module, you practice using PowerShell on your computer. PowerShell is available across platforms. However, if you use a computer that runs Linux, macOS, or an older version of Windows, you need to install it.</p> <p>Instructions for installing PowerShell are different for each OS. Before you continue, take a few minutes to install PowerShell or to verify your PowerShell installation. The next unit in this module shows you how to verify your installation.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#windows","title":"Windows","text":"<p>If you're running Windows 8 or later, a version of PowerShell called\u00a0Windows PowerShell\u00a0should already be installed. This version differs slightly from the most up-to-date PowerShell release, but it works fine for learning purposes.</p> <p>You can open Windows PowerShell from the Start menu.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#other-operating-systems","title":"Other operating systems","text":"<p>If your computer runs something other than Windows 8 or later, you need to install PowerShell. To find the installation instructions for your OS, see\u00a0Install various versions of PowerShell.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#powershell-extension-for-visual-studio-code","title":"PowerShell extension for Visual Studio Code","text":"<p>We recommend that you use the\u00a0PowerShell extension for Visual Studio Code\u00a0to author your PowerShell scripts and to run the commands in this module. This extension lets you run commands, and also helps you with snippets, code completion, and syntax highlighting.</p>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#locate-commands","title":"Locate commands","text":"<p>A\u00a0cmdlet\u00a0(pronounced \"command-let\") is a compiled command. A cmdlet can be developed in .NET or .NET Core and invoked as a command within PowerShell. Thousands of cmdlets are available in your PowerShell installation. The challenge lies in discovering what the cmdlets are and what they can do for you.</p> <p>Cmdlets are named according to a verb-noun naming standard. This pattern can help you to understand what they do and how to search for them. It also helps cmdlet developers create consistent names. You can see the list of approved verbs by using the\u00a0<code>Get-Verb</code>\u00a0cmdlet. Verbs are organized according to activity type and function.</p> <p>Here's a part of the output from running\u00a0<code>Get-Verb</code>:</p> <p>OutputCopy</p> <pre><code>Verb        AliasPrefix Group          Description\n----        ----------- -----          -----------\nAdd         a           Common         Adds a resource to a container, or atta\u2026\nClear       cl          Common         Removes all the resources from a contai\u2026\n</code></pre> <p>This listing shows the verb and its description. Cmdlet developers should use an approved verb, and also ensure that the verb description fits their cmdlet's function.</p> <p>Three core cmdlets allow you to delve into what cmdlets exist and what they do:</p> <ul> <li>Get-Command: The\u00a0<code>Get-Command</code>\u00a0cmdlet lists all of the available cmdlets on your system. Filter the list to quickly find the command you need.</li> <li>Get-Help: Run the\u00a0<code>Get-Help</code>\u00a0core cmdlet to invoke a built-in help system. You can also run an alias\u00a0<code>help</code>\u00a0command to invoke\u00a0<code>Get-Help</code>\u00a0but improve the reading experience by paginating the response.</li> <li>Get-Member: When you call a command, the response is an object that contains many properties. Run the\u00a0<code>Get-Member</code>\u00a0core cmdlet to drill down into that response and learn more about it.</li> </ul>","tags":["azure","az104"]},{"location":"blog/2024/11/14/Az%20104%20-%20Prerequisites%20Azure%20Administrator/#locate-commands-by-using-get-command","title":"Locate commands by using Get-Command","text":"<p>When you run the\u00a0<code>Get-Command</code>\u00a0cmdlet in Cloud Shell, you get a list of every command that's installed in PowerShell. Because thousands of commands are installed, you need a way to filter the response so you can quickly locate the command that you need.</p> <p>To filter the list, keep in mind the verb-noun naming standard for cmdlets. For example, in the\u00a0<code>Get-Random</code>\u00a0command,\u00a0<code>Get</code>\u00a0is the verb and\u00a0<code>Random</code>\u00a0is the noun. Use flags to target either the verb or the noun in the command you want. The flag you specify expects a value that's a string. You can add pattern-matching characters to that string to ensure you express that, for example, a flag's value should start or end with a certain string.</p> <p>These examples show how to use flags to filter a command list:</p> <ul> <li> <p>-Noun: The\u00a0<code>-Noun</code>\u00a0flag targets the part of the command name that's related to the noun. Here's a typical search for a command name using\u00a0alias\u00a0as the noun for which we're searching:</p> <p>PowerShellCopy</p> <pre><code>Get-Command -Noun alias*\n</code></pre> <p>This command searches for all cmdlets whose noun part starts with\u00a0<code>alias</code>.</p> </li> <li> <p>-Verb: The\u00a0<code>-Verb</code>\u00a0flag targets the part of the command name that's related to the verb. You can combine the\u00a0<code>-Noun</code>\u00a0flag and the\u00a0<code>-Verb</code>\u00a0flag to create an even more detailed search query and type. Here's an example:</p> <p>PowerShellCopy</p> <pre><code>Get-Command -Verb Get -Noun alias*\n</code></pre> <p>Now you've narrowed the search to specify that the verb part needs to match\u00a0<code>Get</code>, and the noun part needs to match\u00a0<code>alias</code>.</p> </li> </ul>","tags":["azure","az104"]},{"location":"blog/archive/2024/","title":"2024","text":""}]}